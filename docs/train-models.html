<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 3 Train Predictive Modesl | Classification and Clustering: Case Study with CRC Gene Expression Data</title>
  <meta name="description" content="Classification and clustering methodes are explored using colorectal data from GEO website" />
  <meta name="generator" content="bookdown 0.20.6 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 3 Train Predictive Modesl | Classification and Clustering: Case Study with CRC Gene Expression Data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Classification and clustering methodes are explored using colorectal data from GEO website" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 3 Train Predictive Modesl | Classification and Clustering: Case Study with CRC Gene Expression Data" />
  
  <meta name="twitter:description" content="Classification and clustering methodes are explored using colorectal data from GEO website" />
  

<meta name="author" content="Francois Collin" />


<meta name="date" content="2020-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="load-data.html"/>
<link rel="next" href="comp-models.html"/>
<script src="libs/header-attrs-2.4/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preamble</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#outline"><i class="fa fa-check"></i><b>1.1</b> Outline</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#data-preprocessing"><i class="fa fa-check"></i><b>1.2</b> Data Preprocessing</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#affymetrix-probe-sets-vs-genes"><i class="fa fa-check"></i><b>1.3</b> Affymetrix Probe Sets vs Genes</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#building-a-classifier"><i class="fa fa-check"></i><b>1.4</b> Building a Classifier</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#classifier-assessment"><i class="fa fa-check"></i><b>1.5</b> Classifier Assessment</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#subclass-discovery"><i class="fa fa-check"></i><b>1.6</b> Subclass Discovery</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="load-data.html"><a href="load-data.html"><i class="fa fa-check"></i><b>2</b> Load Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="load-data.html"><a href="load-data.html#download-datasets"><i class="fa fa-check"></i><b>2.1</b> Download Datasets</a></li>
<li class="chapter" data-level="2.2" data-path="load-data.html"><a href="load-data.html#peek-into-datasets"><i class="fa fa-check"></i><b>2.2</b> Peek into Datasets</a></li>
<li class="chapter" data-level="2.3" data-path="load-data.html"><a href="load-data.html#dataset-cleaning"><i class="fa fa-check"></i><b>2.3</b> Dataset Cleaning</a></li>
<li class="chapter" data-level="2.4" data-path="load-data.html"><a href="load-data.html#data-pooling"><i class="fa fa-check"></i><b>2.4</b> Data Pooling</a></li>
<li class="chapter" data-level="2.5" data-path="load-data.html"><a href="load-data.html#batch-correction"><i class="fa fa-check"></i><b>2.5</b> Batch Correction</a></li>
<li class="chapter" data-level="2.6" data-path="load-data.html"><a href="load-data.html#separate-data-set-into-train-and-test-subsets"><i class="fa fa-check"></i><b>2.6</b> Separate Data Set into Train and Test Subsets</a></li>
<li class="chapter" data-level="2.7" data-path="load-data.html"><a href="load-data.html#save-gene-sets"><i class="fa fa-check"></i><b>2.7</b> Save Gene Sets</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="train-models.html"><a href="train-models.html"><i class="fa fa-check"></i><b>3</b> Train Predictive Modesl</a>
<ul>
<li class="chapter" data-level="3.1" data-path="train-models.html"><a href="train-models.html#knn---k-nearest-neighbors"><i class="fa fa-check"></i><b>3.1</b> knn - k nearest neighbors</a></li>
<li class="chapter" data-level="3.2" data-path="train-models.html"><a href="train-models.html#rf---random-forests"><i class="fa fa-check"></i><b>3.2</b> rf - Random forests</a></li>
<li class="chapter" data-level="3.3" data-path="train-models.html"><a href="train-models.html#svmradial---support-vector-machines-rbf-kernel"><i class="fa fa-check"></i><b>3.3</b> svmRadial - Support vector machines (RBF kernel)</a></li>
<li class="chapter" data-level="3.4" data-path="train-models.html"><a href="train-models.html#gbm---boosted-trees"><i class="fa fa-check"></i><b>3.4</b> gbm - Boosted trees</a></li>
<li class="chapter" data-level="3.5" data-path="train-models.html"><a href="train-models.html#xgblinear---extreme-gradient-boosting"><i class="fa fa-check"></i><b>3.5</b> xgbLinear - eXtreme Gradient Boosting</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="comp-models.html"><a href="comp-models.html"><i class="fa fa-check"></i><b>4</b> Compare Predictive Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="comp-models.html"><a href="comp-models.html#load-models"><i class="fa fa-check"></i><b>4.1</b> Load Models</a></li>
<li class="chapter" data-level="4.2" data-path="comp-models.html"><a href="comp-models.html#compare-times"><i class="fa fa-check"></i><b>4.2</b> Compare Times</a></li>
<li class="chapter" data-level="4.3" data-path="comp-models.html"><a href="comp-models.html#compare-prediction-accuracy"><i class="fa fa-check"></i><b>4.3</b> Compare Prediction Accuracy</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="comp-models.html"><a href="comp-models.html#train-data-accuracy"><i class="fa fa-check"></i><b>4.3.1</b> Train Data Accuracy</a></li>
<li class="chapter" data-level="4.3.2" data-path="comp-models.html"><a href="comp-models.html#out-of-sample-train-data-accuracy"><i class="fa fa-check"></i><b>4.3.2</b> Out of Sample Train Data Accuracy</a></li>
<li class="chapter" data-level="4.3.3" data-path="comp-models.html"><a href="comp-models.html#test-data-accuracy"><i class="fa fa-check"></i><b>4.3.3</b> Test Data Accuracy</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="comp-models.html"><a href="comp-models.html#compare-models-in-terms-of-roc"><i class="fa fa-check"></i><b>4.4</b> Compare Models in Terms of ROC</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="comp-models.html"><a href="comp-models.html#training-data-roc"><i class="fa fa-check"></i><b>4.4.1</b> Training Data ROC</a></li>
<li class="chapter" data-level="4.4.2" data-path="comp-models.html"><a href="comp-models.html#out-of-sample-train-average-over-repeats"><i class="fa fa-check"></i><b>4.4.2</b> Out-of-sample Train: Average over Repeats</a></li>
<li class="chapter" data-level="4.4.3" data-path="comp-models.html"><a href="comp-models.html#out-of-sample-set.train-individual-repeats"><i class="fa fa-check"></i><b>4.4.3</b> Out-of-sample Set.Train: Individual Repeats</a></li>
<li class="chapter" data-level="4.4.4" data-path="comp-models.html"><a href="comp-models.html#compare-predicted-probabilities"><i class="fa fa-check"></i><b>4.4.4</b> Compare Predicted Probabilities</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="comp-models.html"><a href="comp-models.html#look-at-variable-importance"><i class="fa fa-check"></i><b>4.5</b> Look at Variable Importance</a></li>
<li class="chapter" data-level="4.6" data-path="comp-models.html"><a href="comp-models.html#classification-discussion"><i class="fa fa-check"></i><b>4.6</b> Classification: Discussion</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="comp-models.html"><a href="comp-models.html#nearest-shrunken-centroids-does-well"><i class="fa fa-check"></i><b>4.6.1</b> Nearest shrunken centroids does well</a></li>
<li class="chapter" data-level="4.6.2" data-path="comp-models.html"><a href="comp-models.html#lack-of-agreement-with-literature-gene-sets"><i class="fa fa-check"></i><b>4.6.2</b> Lack of agreement with literature gene sets</a></li>
<li class="chapter" data-level="4.6.3" data-path="comp-models.html"><a href="comp-models.html#models-could-be-better-optimized"><i class="fa fa-check"></i><b>4.6.3</b> Models could be better optimized</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>5</b> Cluster Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="clustering.html"><a href="clustering.html#pam-clustering"><i class="fa fa-check"></i><b>5.1</b> PAM Clustering</a></li>
<li class="chapter" data-level="5.2" data-path="clustering.html"><a href="clustering.html#bootstrap-aggregation-of-clusters"><i class="fa fa-check"></i><b>5.2</b> Bootstrap Aggregation of Clusters</a></li>
<li class="chapter" data-level="5.3" data-path="clustering.html"><a href="clustering.html#t-sne"><i class="fa fa-check"></i><b>5.3</b> t-SNE</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="clustering.html"><a href="clustering.html#t-sne-pam"><i class="fa fa-check"></i><b>5.3.1</b> t-SNE + PAM</a></li>
<li class="chapter" data-level="5.3.2" data-path="clustering.html"><a href="clustering.html#t-sne-bagclust2"><i class="fa fa-check"></i><b>5.3.2</b> t-SNE + BagClust2</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="clustering.html"><a href="clustering.html#cluster-analysis-discussion"><i class="fa fa-check"></i><b>5.4</b> Cluster Analysis: Discussion</a></li>
<li class="chapter" data-level="5.5" data-path="clustering.html"><a href="clustering.html#next-step-look-for-subgroups-in-the-mss-population---an-open-biological-question."><i class="fa fa-check"></i><b>5.5</b> Next Step: Look for subgroups in the MSS population - an open biological question.</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>6</b> Results Summary</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Classification and Clustering: Case Study with CRC Gene Expression Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="train-models" class="section level1" number="3">
<h1><span class="header-section-number">Section 3</span> Train Predictive Modesl</h1>
<p>We are ready to use the Training data to evaluate various predictive models.</p>
<p>Set up training parameters:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="train-models.html#cb8-1" aria-hidden="true"></a> <span class="kw">suppressMessages</span>(<span class="kw">require</span>(caret))</span>
<span id="cb8-2"><a href="train-models.html#cb8-2" aria-hidden="true"></a></span>
<span id="cb8-3"><a href="train-models.html#cb8-3" aria-hidden="true"></a> SelGenes.CV &lt;-<span class="st"> </span><span class="kw">paste</span>(SelGenes, <span class="st">&#39;.CV.&#39;</span>, <span class="kw">paste</span>(<span class="kw">unlist</span>(CV), <span class="dt">collapse=</span><span class="st">&#39;_&#39;</span>),<span class="dt">sep=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb8-4"><a href="train-models.html#cb8-4" aria-hidden="true"></a></span>
<span id="cb8-5"><a href="train-models.html#cb8-5" aria-hidden="true"></a> cvControl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="dt">number=</span>CV<span class="op">$</span>Num, <span class="dt">repeats=</span>CV<span class="op">$</span>Rep,</span>
<span id="cb8-6"><a href="train-models.html#cb8-6" aria-hidden="true"></a>                           <span class="dt">classProbs =</span> <span class="ot">TRUE</span>, <span class="dt">summaryFunction =</span> twoClassSummary,</span>
<span id="cb8-7"><a href="train-models.html#cb8-7" aria-hidden="true"></a>                           <span class="dt">savePredictions=</span><span class="st">&#39;final&#39;</span>)</span>
<span id="cb8-8"><a href="train-models.html#cb8-8" aria-hidden="true"></a></span>
<span id="cb8-9"><a href="train-models.html#cb8-9" aria-hidden="true"></a> <span class="co"># Load Data</span></span>
<span id="cb8-10"><a href="train-models.html#cb8-10" aria-hidden="true"></a> <span class="kw">loadObj</span>(<span class="kw">paste0</span>(<span class="st">&#39;Train.&#39;</span>,SelGenes,<span class="st">&#39;.vec&#39;</span>), <span class="st">&#39;SelGenes.vec&#39;</span>)</span>
<span id="cb8-11"><a href="train-models.html#cb8-11" aria-hidden="true"></a> </span>
<span id="cb8-12"><a href="train-models.html#cb8-12" aria-hidden="true"></a> <span class="kw">load</span>(<span class="dt">file=</span><span class="kw">file.path</span>(WRKDIR, <span class="st">&#39;Data&#39;</span>, <span class="st">&#39;Train.Expr.mtx&#39;</span>))</span>
<span id="cb8-13"><a href="train-models.html#cb8-13" aria-hidden="true"></a> Train.SelGenes.Expr.mtx &lt;-<span class="st"> </span>Train.Expr.mtx[, SelGenes.vec]</span>
<span id="cb8-14"><a href="train-models.html#cb8-14" aria-hidden="true"></a> <span class="kw">rm</span>(Train.Expr.mtx)</span>
<span id="cb8-15"><a href="train-models.html#cb8-15" aria-hidden="true"></a></span>
<span id="cb8-16"><a href="train-models.html#cb8-16" aria-hidden="true"></a> <span class="kw">load</span>(<span class="dt">file=</span><span class="kw">file.path</span>(WRKDIR, <span class="st">&#39;Data&#39;</span>, <span class="st">&#39;Train.Label.vec&#39;</span>))</span>
<span id="cb8-17"><a href="train-models.html#cb8-17" aria-hidden="true"></a></span>
<span id="cb8-18"><a href="train-models.html#cb8-18" aria-hidden="true"></a> <span class="co">#dim(Train.SelGenes.Expr.mtx);length(Train.Label.vec)</span></span></code></pre></div>
<!-- ######################################################################## -->
<!-- ######################################################################## -->
<p>We will use the Top10VarGenes gene set in this analysis.
Model tuning and optimization will be done based on
10 repetitions of 5-fold cross-validations.
This provides 10 cross-validated, or out-of-sample, predicted values
for each sample in the training set. The distribution of predicted values
can be examined to identify hard to predict samples. Some of these
samples may potentially be mis-labelled, or may be hard to fit for other
reasons. One might consider doing an analysis which exludes these samples
from the training set to see what impact they have on the fits.</p>
<p>Some of the models which can be evaluated with <code>caret</code> include:</p>
<ul>
<li>stepLDA - Linear Discriminant Analysis with Stepwise Feature Selection</li>
<li>stepQDA - Qaudratic Discriminant Analysis with Stepwise Feature Selection</li>
<li>knn - k nearest neighbors</li>
<li>pam - Nearest shrunken centroids</li>
<li>rf - Random forests</li>
<li>svmRadial - Support vector machines (RBF kernel)</li>
<li>gbm - Boosted trees</li>
<li>xgbLinear - eXtreme Gradient Boosting</li>
<li>xgbTree - eXtreme Gradient Boosting</li>
<li>neuralnet - neural network</li>
</ul>
<p>Many more <a href="https://topepo.github.io/caret/available-models.html">models</a>
can be implemented and evaluated with <code>caret</code>, including <code>deep learning</code> methods.</p>
<!-- 
Method requiring explicit dimensionality reduction:
* dlda, lda, qda - Classical linear disrimanent alalysis preceded  by variable selection

Methods which are not adapted to classification problems (penalized regression methods):
* pls - Partial least squares
* lasso - The lasso
* enet - Elastic net

These methods dont work.
* rda - Regularized discriminant analysis
* multinom - Logistic/Multinomial regression
* nnet - neural network
-->
<!--
## stepLDAFit - Stepwise linear discriminant analysis
-->
<!-- SHOULD HAVE PRINTED IN THE SAME CHUNK! -->
<!-- ######################################################################## -->
<!--
## stepQDAFit - Stepwise quadratic discriminant analysis
-->
<!-- SHOULD HAVE PRINTED IN THE SAME CHUNK! -->
<!-- ######################################################################## -->
<div id="knn---k-nearest-neighbors" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> knn - k nearest neighbors</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="train-models.html#cb9-1" aria-hidden="true"></a> <span class="co"># CHANGE THIS LINE TO CLEAR CACHE</span></span>
<span id="cb9-2"><a href="train-models.html#cb9-2" aria-hidden="true"></a> <span class="co">################################# </span></span>
<span id="cb9-3"><a href="train-models.html#cb9-3" aria-hidden="true"></a> <span class="kw">set.seed</span>(<span class="dv">12379</span>)</span>
<span id="cb9-4"><a href="train-models.html#cb9-4" aria-hidden="true"></a> SelGenes.knnFit.tm &lt;-<span class="st"> </span><span class="kw">system.time</span>(</span>
<span id="cb9-5"><a href="train-models.html#cb9-5" aria-hidden="true"></a>  SelGenes.knnFit &lt;-<span class="st"> </span><span class="kw">train</span>(Train.SelGenes.Expr.mtx, Train.Label.vec,</span>
<span id="cb9-6"><a href="train-models.html#cb9-6" aria-hidden="true"></a>               <span class="dt">method=</span><span class="st">&quot;knn&quot;</span>, <span class="dt">tuneLength=</span><span class="dv">10</span>,</span>
<span id="cb9-7"><a href="train-models.html#cb9-7" aria-hidden="true"></a>               <span class="dt">trControl=</span>cvControl, <span class="dt">preProc=</span><span class="kw">c</span>(<span class="st">&#39;center&#39;</span>,<span class="st">&#39;scale&#39;</span>))</span>
<span id="cb9-8"><a href="train-models.html#cb9-8" aria-hidden="true"></a> )</span>
<span id="cb9-9"><a href="train-models.html#cb9-9" aria-hidden="true"></a> <span class="kw">print</span>(SelGenes.knnFit.tm)</span>
<span id="cb9-10"><a href="train-models.html#cb9-10" aria-hidden="true"></a></span>
<span id="cb9-11"><a href="train-models.html#cb9-11" aria-hidden="true"></a> <span class="kw">saveObj</span>(<span class="kw">paste0</span>(SelGenes.CV, <span class="st">&#39;.knnFit&#39;</span>), <span class="st">&#39;SelGenes.knnFit&#39;</span>)</span></code></pre></div>
<!-- SHOULD HAVE PRINTED IN THE SAME CHUNK! -->
<!-- ######################################################################## -->
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="train-models.html#cb10-1" aria-hidden="true"></a> <span class="kw">set.seed</span>(<span class="dv">12379</span>)</span>
<span id="cb10-2"><a href="train-models.html#cb10-2" aria-hidden="true"></a> SelGenes.pamFit.tm &lt;-<span class="st"> </span><span class="kw">system.time</span>(</span>
<span id="cb10-3"><a href="train-models.html#cb10-3" aria-hidden="true"></a> SelGenes.pamFit &lt;-<span class="st"> </span><span class="kw">train</span>(Train.SelGenes.Expr.mtx, Train.Label.vec,</span>
<span id="cb10-4"><a href="train-models.html#cb10-4" aria-hidden="true"></a>               <span class="dt">method=</span><span class="st">&quot;pam&quot;</span>,</span>
<span id="cb10-5"><a href="train-models.html#cb10-5" aria-hidden="true"></a>               <span class="dt">trControl=</span>cvControl, <span class="dt">preProc=</span><span class="kw">c</span>(<span class="st">&#39;center&#39;</span>,<span class="st">&#39;scale&#39;</span>))</span>
<span id="cb10-6"><a href="train-models.html#cb10-6" aria-hidden="true"></a> )</span>
<span id="cb10-7"><a href="train-models.html#cb10-7" aria-hidden="true"></a> <span class="kw">print</span>(SelGenes.pamFit.tm)</span>
<span id="cb10-8"><a href="train-models.html#cb10-8" aria-hidden="true"></a></span>
<span id="cb10-9"><a href="train-models.html#cb10-9" aria-hidden="true"></a> <span class="kw">saveObj</span>(<span class="kw">paste0</span>(SelGenes.CV, <span class="st">&#39;.pamFit&#39;</span>), <span class="st">&#39;SelGenes.pamFit&#39;</span>)</span></code></pre></div>
<!-- SHOULD HAVE PRINTED IN THE SAME CHUNK! -->
<!-- ######################################################################## -->
</div>
<div id="rf---random-forests" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> rf - Random forests</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="train-models.html#cb11-1" aria-hidden="true"></a> <span class="kw">set.seed</span>(<span class="dv">12379</span>)</span>
<span id="cb11-2"><a href="train-models.html#cb11-2" aria-hidden="true"></a> SelGenes.rfFit.tm &lt;-<span class="st"> </span><span class="kw">system.time</span>(</span>
<span id="cb11-3"><a href="train-models.html#cb11-3" aria-hidden="true"></a> SelGenes.rfFit &lt;-<span class="st"> </span><span class="kw">train</span>(Train.SelGenes.Expr.mtx, Train.Label.vec,</span>
<span id="cb11-4"><a href="train-models.html#cb11-4" aria-hidden="true"></a>               <span class="dt">method=</span><span class="st">&quot;rf&quot;</span>,</span>
<span id="cb11-5"><a href="train-models.html#cb11-5" aria-hidden="true"></a>               <span class="dt">trControl=</span>cvControl, <span class="dt">preProc=</span><span class="kw">c</span>(<span class="st">&#39;center&#39;</span>,<span class="st">&#39;scale&#39;</span>))</span>
<span id="cb11-6"><a href="train-models.html#cb11-6" aria-hidden="true"></a> )</span>
<span id="cb11-7"><a href="train-models.html#cb11-7" aria-hidden="true"></a> <span class="kw">print</span>(SelGenes.rfFit.tm)</span>
<span id="cb11-8"><a href="train-models.html#cb11-8" aria-hidden="true"></a></span>
<span id="cb11-9"><a href="train-models.html#cb11-9" aria-hidden="true"></a> <span class="kw">saveObj</span>(<span class="kw">paste0</span>(SelGenes.CV, <span class="st">&#39;.rfFit&#39;</span>), <span class="st">&#39;SelGenes.rfFit&#39;</span>)</span></code></pre></div>
<!-- SHOULD HAVE PRINTED IN THE SAME CHUNK! -->
<!-- ######################################################################## -->
</div>
<div id="svmradial---support-vector-machines-rbf-kernel" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> svmRadial - Support vector machines (RBF kernel)</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="train-models.html#cb12-1" aria-hidden="true"></a> <span class="kw">set.seed</span>(<span class="dv">12379</span>)</span>
<span id="cb12-2"><a href="train-models.html#cb12-2" aria-hidden="true"></a> SelGenes.svmRadialFit.tm &lt;-<span class="st"> </span><span class="kw">system.time</span>(</span>
<span id="cb12-3"><a href="train-models.html#cb12-3" aria-hidden="true"></a> SelGenes.svmRadialFit &lt;-<span class="st"> </span><span class="kw">train</span>(Train.SelGenes.Expr.mtx, Train.Label.vec,</span>
<span id="cb12-4"><a href="train-models.html#cb12-4" aria-hidden="true"></a>               <span class="dt">method=</span><span class="st">&quot;svmRadial&quot;</span>,</span>
<span id="cb12-5"><a href="train-models.html#cb12-5" aria-hidden="true"></a>               <span class="dt">trControl=</span>cvControl, <span class="dt">preProc=</span><span class="kw">c</span>(<span class="st">&#39;center&#39;</span>,<span class="st">&#39;scale&#39;</span>))</span>
<span id="cb12-6"><a href="train-models.html#cb12-6" aria-hidden="true"></a> )</span>
<span id="cb12-7"><a href="train-models.html#cb12-7" aria-hidden="true"></a> <span class="kw">print</span>(SelGenes.svmRadialFit.tm)</span>
<span id="cb12-8"><a href="train-models.html#cb12-8" aria-hidden="true"></a></span>
<span id="cb12-9"><a href="train-models.html#cb12-9" aria-hidden="true"></a> <span class="kw">saveObj</span>(<span class="kw">paste0</span>(SelGenes.CV, <span class="st">&#39;.svmRadialFit&#39;</span>), <span class="st">&#39;SelGenes.svmRadialFit&#39;</span>)</span></code></pre></div>
<!-- SHOULD HAVE PRINTED IN THE SAME CHUNK! -->
<!-- ######################################################################## -->
</div>
<div id="gbm---boosted-trees" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> gbm - Boosted trees</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="train-models.html#cb13-1" aria-hidden="true"></a> <span class="kw">set.seed</span>(<span class="dv">12379</span>)</span>
<span id="cb13-2"><a href="train-models.html#cb13-2" aria-hidden="true"></a> SelGenes.gbmFit.tm &lt;-<span class="st"> </span><span class="kw">system.time</span>(</span>
<span id="cb13-3"><a href="train-models.html#cb13-3" aria-hidden="true"></a> SelGenes.gbmFit &lt;-<span class="st"> </span><span class="kw">train</span>(Train.SelGenes.Expr.mtx, Train.Label.vec,</span>
<span id="cb13-4"><a href="train-models.html#cb13-4" aria-hidden="true"></a>               <span class="dt">method=</span><span class="st">&quot;gbm&quot;</span>, <span class="dt">verbose=</span>F,</span>
<span id="cb13-5"><a href="train-models.html#cb13-5" aria-hidden="true"></a>               <span class="dt">trControl=</span>cvControl, <span class="dt">preProc=</span><span class="kw">c</span>(<span class="st">&#39;center&#39;</span>,<span class="st">&#39;scale&#39;</span>))</span>
<span id="cb13-6"><a href="train-models.html#cb13-6" aria-hidden="true"></a> )</span>
<span id="cb13-7"><a href="train-models.html#cb13-7" aria-hidden="true"></a> <span class="kw">print</span>(SelGenes.gbmFit.tm)</span>
<span id="cb13-8"><a href="train-models.html#cb13-8" aria-hidden="true"></a></span>
<span id="cb13-9"><a href="train-models.html#cb13-9" aria-hidden="true"></a> <span class="kw">saveObj</span>(<span class="kw">paste0</span>(SelGenes.CV, <span class="st">&#39;.gbmFit&#39;</span>), <span class="st">&#39;SelGenes.gbmFit&#39;</span>)</span></code></pre></div>
<!-- SHOULD HAVE PRINTED IN THE SAME CHUNK! -->
<!-- ######################################################################## -->
</div>
<div id="xgblinear---extreme-gradient-boosting" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> xgbLinear - eXtreme Gradient Boosting</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="train-models.html#cb14-1" aria-hidden="true"></a> <span class="kw">set.seed</span>(<span class="dv">12379</span>)</span>
<span id="cb14-2"><a href="train-models.html#cb14-2" aria-hidden="true"></a> SelGenes.xgbLinearFit.tm &lt;-<span class="st"> </span><span class="kw">system.time</span>(</span>
<span id="cb14-3"><a href="train-models.html#cb14-3" aria-hidden="true"></a> SelGenes.xgbLinearFit &lt;-<span class="st"> </span><span class="kw">train</span>(Train.SelGenes.Expr.mtx, Train.Label.vec,</span>
<span id="cb14-4"><a href="train-models.html#cb14-4" aria-hidden="true"></a>               <span class="dt">method=</span><span class="st">&quot;xgbLinear&quot;</span>, <span class="dt">verbose=</span>F,</span>
<span id="cb14-5"><a href="train-models.html#cb14-5" aria-hidden="true"></a>               <span class="dt">trControl=</span>cvControl, <span class="dt">preProc=</span><span class="kw">c</span>(<span class="st">&#39;center&#39;</span>,<span class="st">&#39;scale&#39;</span>))</span>
<span id="cb14-6"><a href="train-models.html#cb14-6" aria-hidden="true"></a> )</span>
<span id="cb14-7"><a href="train-models.html#cb14-7" aria-hidden="true"></a> <span class="kw">print</span>(SelGenes.xgbLinearFit.tm)</span>
<span id="cb14-8"><a href="train-models.html#cb14-8" aria-hidden="true"></a></span>
<span id="cb14-9"><a href="train-models.html#cb14-9" aria-hidden="true"></a> <span class="kw">saveObj</span>(<span class="kw">paste0</span>(SelGenes.CV, <span class="st">&#39;.xgbLinearFit&#39;</span>), <span class="st">&#39;SelGenes.xgbLinearFit&#39;</span>)</span></code></pre></div>
<!-- SHOULD HAVE PRINTED IN THE SAME CHUNK! -->
<!-- ######################################################################## -->
<!-- TAKES TOOOO LOOOOONG 
## xgbTree - eXtreme Gradient Boosting
-->
<!-- SHOULD HAVE PRINTED IN THE SAME CHUNK! -->
<!-- ######################################################################## -->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="load-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="comp-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ExploreCRC.pdf", "ExploreCRC.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
