<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 2 Load Data | Classification and Clustering: Case Study with CRC Gene Expression Data</title>
  <meta name="description" content="Classification and clustering methodes are explored using colorectal data from GEO website" />
  <meta name="generator" content="bookdown 0.20.6 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 2 Load Data | Classification and Clustering: Case Study with CRC Gene Expression Data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Classification and clustering methodes are explored using colorectal data from GEO website" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 2 Load Data | Classification and Clustering: Case Study with CRC Gene Expression Data" />
  
  <meta name="twitter:description" content="Classification and clustering methodes are explored using colorectal data from GEO website" />
  

<meta name="author" content="Francois Collin" />


<meta name="date" content="2020-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="train-models.html"/>
<script src="libs/header-attrs-2.4/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.15/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<script type="text/javascript">
// source:https://stackoverflow.com/questions/45360998/code-folding-in-bookdown
// toggle visibility of R source blocks in R Markdown output
function toggle_R() {
  var x = document.getElementsByClassName('r');
  if (x.length == 0) return;
  function toggle_vis(o) {
    var d = o.style.display;
    o.style.display = (d == 'block' || d == '') ? 'none':'block';
  }

  for (i = 0; i < x.length; i++) {
    var y = x[i];
    if (y.tagName.toLowerCase() === 'pre') toggle_vis(y);
  }

    var elem = document.getElementById("myButton1");
    if (elem.value === "Hide Global") elem.value = "Show Global";
    else elem.value = "Hide Global";
}

document.write('<input onclick="toggle_R();" type="button" value="Hide Global" id="myButton1" style="position: absolute; top: 10%; right: 2%; z-index: 200"></input>')

</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preamble</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#outline"><i class="fa fa-check"></i><b>1.1</b> Outline</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#data-preprocessing"><i class="fa fa-check"></i><b>1.2</b> Data Preprocessing</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#affymetrix-probe-sets-vs-genes"><i class="fa fa-check"></i><b>1.3</b> Affymetrix Probe Sets vs Genes</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#building-a-classifier"><i class="fa fa-check"></i><b>1.4</b> Building a Classifier</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#classifier-assessment"><i class="fa fa-check"></i><b>1.5</b> Classifier Assessment</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#subclass-discovery"><i class="fa fa-check"></i><b>1.6</b> Subclass Discovery</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="load-data.html"><a href="load-data.html"><i class="fa fa-check"></i><b>2</b> Load Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="load-data.html"><a href="load-data.html#download-datasets"><i class="fa fa-check"></i><b>2.1</b> Download Datasets</a></li>
<li class="chapter" data-level="2.2" data-path="load-data.html"><a href="load-data.html#peek-into-datasets"><i class="fa fa-check"></i><b>2.2</b> Peek into Datasets</a></li>
<li class="chapter" data-level="2.3" data-path="load-data.html"><a href="load-data.html#dataset-cleaning"><i class="fa fa-check"></i><b>2.3</b> Dataset Cleaning</a></li>
<li class="chapter" data-level="2.4" data-path="load-data.html"><a href="load-data.html#data-pooling"><i class="fa fa-check"></i><b>2.4</b> Data Pooling</a></li>
<li class="chapter" data-level="2.5" data-path="load-data.html"><a href="load-data.html#batch-correction"><i class="fa fa-check"></i><b>2.5</b> Batch Correction</a></li>
<li class="chapter" data-level="2.6" data-path="load-data.html"><a href="load-data.html#separate-data-set-into-train-and-test-subsets"><i class="fa fa-check"></i><b>2.6</b> Separate Data Set into Train and Test Subsets</a></li>
<li class="chapter" data-level="2.7" data-path="load-data.html"><a href="load-data.html#save-gene-sets"><i class="fa fa-check"></i><b>2.7</b> Save Gene Sets</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="train-models.html"><a href="train-models.html"><i class="fa fa-check"></i><b>3</b> Train Predictive Models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="train-models.html"><a href="train-models.html#glmnet---elastic-net-regularized-generalized-linear-models"><i class="fa fa-check"></i><b>3.1</b> glmnet - Elastic-Net Regularized Generalized Linear Models</a></li>
<li class="chapter" data-level="3.2" data-path="train-models.html"><a href="train-models.html#enet---elastic-net-regularized-generalized-linear-models"><i class="fa fa-check"></i><b>3.2</b> enet - Elastic-Net Regularized Generalized Linear Models</a></li>
<li class="chapter" data-level="3.3" data-path="train-models.html"><a href="train-models.html#knn---k-nearest-neighbors"><i class="fa fa-check"></i><b>3.3</b> knn - k nearest neighbors</a></li>
<li class="chapter" data-level="3.4" data-path="train-models.html"><a href="train-models.html#pam---nearest-shrunken-centroid"><i class="fa fa-check"></i><b>3.4</b> pam - nearest shrunken centroid</a></li>
<li class="chapter" data-level="3.5" data-path="train-models.html"><a href="train-models.html#svmradial---support-vector-machines-rbf-kernel"><i class="fa fa-check"></i><b>3.5</b> svmRadial - Support vector machines (RBF kernel)</a></li>
<li class="chapter" data-level="3.6" data-path="train-models.html"><a href="train-models.html#gbm---boosted-trees"><i class="fa fa-check"></i><b>3.6</b> gbm - Boosted trees</a></li>
<li class="chapter" data-level="3.7" data-path="train-models.html"><a href="train-models.html#xgblinear---extreme-gradient-boosting"><i class="fa fa-check"></i><b>3.7</b> xgbLinear - eXtreme Gradient Boosting</a></li>
<li class="chapter" data-level="3.8" data-path="train-models.html"><a href="train-models.html#rf---random-forests"><i class="fa fa-check"></i><b>3.8</b> rf - Random forests</a></li>
<li class="chapter" data-level="3.9" data-path="train-models.html"><a href="train-models.html#stepldafit---stepwise-linear-discriminant-analysis"><i class="fa fa-check"></i><b>3.9</b> stepLDAFit - Stepwise linear discriminant analysis</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="comp-models.html"><a href="comp-models.html"><i class="fa fa-check"></i><b>4</b> Compare Predictive Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="comp-models.html"><a href="comp-models.html#load-models"><i class="fa fa-check"></i><b>4.1</b> Load Models</a></li>
<li class="chapter" data-level="4.2" data-path="comp-models.html"><a href="comp-models.html#compare-times"><i class="fa fa-check"></i><b>4.2</b> Compare Times</a></li>
<li class="chapter" data-level="4.3" data-path="comp-models.html"><a href="comp-models.html#compare-prediction-accuracy"><i class="fa fa-check"></i><b>4.3</b> Compare Prediction Accuracy</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="comp-models.html"><a href="comp-models.html#train-data-accuracy"><i class="fa fa-check"></i><b>4.3.1</b> Train Data Accuracy</a></li>
<li class="chapter" data-level="4.3.2" data-path="comp-models.html"><a href="comp-models.html#out-of-sample-train-data-accuracy"><i class="fa fa-check"></i><b>4.3.2</b> Out of Sample Train Data Accuracy</a></li>
<li class="chapter" data-level="4.3.3" data-path="comp-models.html"><a href="comp-models.html#test-data-accuracy"><i class="fa fa-check"></i><b>4.3.3</b> Test Data Accuracy</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="comp-models.html"><a href="comp-models.html#compare-models-in-terms-of-roc"><i class="fa fa-check"></i><b>4.4</b> Compare Models in Terms of ROC</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="comp-models.html"><a href="comp-models.html#training-data-roc"><i class="fa fa-check"></i><b>4.4.1</b> Training Data ROC</a></li>
<li class="chapter" data-level="4.4.2" data-path="comp-models.html"><a href="comp-models.html#out-of-sample-train-average-over-repeats"><i class="fa fa-check"></i><b>4.4.2</b> Out-of-sample Train: Average over Repeats</a></li>
<li class="chapter" data-level="4.4.3" data-path="comp-models.html"><a href="comp-models.html#out-of-sample-train-set-individual-repeats"><i class="fa fa-check"></i><b>4.4.3</b> Out-of-sample Train Set: Individual Repeats</a></li>
<li class="chapter" data-level="4.4.4" data-path="comp-models.html"><a href="comp-models.html#compare-predicted-probabilities"><i class="fa fa-check"></i><b>4.4.4</b> Compare Predicted Probabilities</a></li>
<li class="chapter" data-level="4.4.5" data-path="comp-models.html"><a href="comp-models.html#compare-predicted-probabilities---test-set"><i class="fa fa-check"></i><b>4.4.5</b> Compare Predicted Probabilities - Test Set</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="comp-models.html"><a href="comp-models.html#look-at-variable-importance"><i class="fa fa-check"></i><b>4.5</b> Look at Variable Importance</a></li>
<li class="chapter" data-level="4.6" data-path="comp-models.html"><a href="comp-models.html#classification-discussion"><i class="fa fa-check"></i><b>4.6</b> Classification: Discussion</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="comp-models.html"><a href="comp-models.html#nearest-shrunken-centroids-does-well"><i class="fa fa-check"></i><b>4.6.1</b> Nearest shrunken centroids does well</a></li>
<li class="chapter" data-level="4.6.2" data-path="comp-models.html"><a href="comp-models.html#lack-of-agreement-with-literature-gene-sets"><i class="fa fa-check"></i><b>4.6.2</b> Lack of agreement with literature gene sets</a></li>
<li class="chapter" data-level="4.6.3" data-path="comp-models.html"><a href="comp-models.html#models-could-be-better-optimized"><i class="fa fa-check"></i><b>4.6.3</b> Models could be better optimized</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>5</b> Cluster Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="clustering.html"><a href="clustering.html#bootstrap-aggregation-of-clusters"><i class="fa fa-check"></i><b>5.1</b> Bootstrap Aggregation of Clusters</a></li>
<li class="chapter" data-level="5.2" data-path="clustering.html"><a href="clustering.html#t-sne"><i class="fa fa-check"></i><b>5.2</b> t-SNE</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="clustering.html"><a href="clustering.html#t-sne-pam"><i class="fa fa-check"></i><b>5.2.1</b> t-SNE + PAM</a></li>
<li class="chapter" data-level="5.2.2" data-path="clustering.html"><a href="clustering.html#t-sne-bagclust2"><i class="fa fa-check"></i><b>5.2.2</b> t-SNE + BagClust2</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="clustering.html"><a href="clustering.html#cluster-analysis-discussion"><i class="fa fa-check"></i><b>5.3</b> Cluster Analysis: Discussion</a></li>
<li class="chapter" data-level="5.4" data-path="clustering.html"><a href="clustering.html#next-step-look-for-subgroups-in-the-mss-population---an-open-biological-question."><i class="fa fa-check"></i><b>5.4</b> Next Step: Look for subgroups in the MSS population - an open biological question.</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>6</b> Results Summary</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Classification and Clustering: Case Study with CRC Gene Expression Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="load-data" class="section level1" number="2">
<h1><span class="header-section-number">Section 2</span> Load Data</h1>
<p>A search on the GEO web site<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
identified the following datasets as potentialy useful for this
exercise. All datasets have Affymetrix gene expression data for a
number of samples annotated with msi status:</p>
<ul>
<li>GSE4554 <span class="citation">[<a href="#ref-Watanabe:2006aa" role="doc-biblioref">10</a>]</span>: [HG-U133_Plus_2] (84 CRC = 33 MSI + 51 MSS)</li>
<li>GSE13067 <span class="citation">[<a href="#ref-Jorissen:2008aa" role="doc-biblioref">11</a>]</span>: [HG-U133_Plus_2] (74 CRC)</li>
<li>GSE13294 <span class="citation">[<a href="#ref-Jorissen:2008aa" role="doc-biblioref">11</a>]</span>: [HG-U133_Plus_2] (89 MSI + 140 MSS + 58 MSI + 77 MSS)</li>
<li>GSE24514 <span class="citation">[<a href="#ref-Alhopuro:2012aa" role="doc-biblioref">12</a>]</span>: [HGU133A] (34 MSI,15 N)</li>
<li>GSE30540 <span class="citation">[<a href="#ref-Watanabe:2012aa" role="doc-biblioref">13</a>]</span>: [HG-U133_Plus_2] (35 stage II and stage III)</li>
<li>GSE35896 <span class="citation">[<a href="#ref-Schlicker:2012aa" role="doc-biblioref">14</a>]</span>: [HG-U133_Plus_2] (62 CRC samples)</li>
<li>GSE75316 <span class="citation">[<a href="#ref-Barras:2017aa" role="doc-biblioref">15</a>]</span>: [HG-U133_Plus_2] (59 CRC samples)</li>
<li>GSE39084 <span class="citation">[<a href="#ref-Kirzin:2014aa" role="doc-biblioref">16</a>]</span>: [HG-U133_Plus_2] (70 CRC samples)</li>
<li>GSE26682 <span class="citation">[<a href="#ref-Schmit:2015aa" role="doc-biblioref">17</a>]</span>: [HG-U133A], [HG-U133_Plus_2] (???)</li>
<li>GSE14526 <span class="citation">[<a href="#ref-Yagi:2010aa" role="doc-biblioref">18</a>]</span>: [HG-U133_Plus_2]</li>
<li>GSE4045 <span class="citation">[<a href="#ref-Laiho:2006aa" role="doc-biblioref">19</a>]</span>: [HG-U133A]</li>
</ul>
<div id="download-datasets" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Download Datasets</h2>
<p>This process is somewhat manual as the GEO data do not follow an entirely standard
format. Each dataset will have to be downloaded one at a time and examined.
Following this step, we can loop again through the datasets and store the necessary
data in a uniform manner.</p>
<p>We can download data from GEO using function
<code>getGEO</code> from package <code>GEOquery</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="load-data.html#cb1-1" aria-hidden="true"></a> <span class="kw">suppressMessages</span>(<span class="kw">require</span>(GEOquery))</span>
<span id="cb1-2"><a href="load-data.html#cb1-2" aria-hidden="true"></a></span>
<span id="cb1-3"><a href="load-data.html#cb1-3" aria-hidden="true"></a> GSE_SET.vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;GSE4554&#39;</span>, <span class="st">&#39;GSE13067&#39;</span>, <span class="st">&#39;GSE13294&#39;</span>, </span>
<span id="cb1-4"><a href="load-data.html#cb1-4" aria-hidden="true"></a>                  <span class="st">&#39;GSE24514&#39;</span>, <span class="st">&#39;GSE30540&#39;</span>, <span class="st">&#39;GSE35896&#39;</span>,</span>
<span id="cb1-5"><a href="load-data.html#cb1-5" aria-hidden="true"></a>                  <span class="st">&#39;GSE75316&#39;</span>, <span class="st">&#39;GSE39084&#39;</span>, <span class="st">&#39;GSE26682&#39;</span>,</span>
<span id="cb1-6"><a href="load-data.html#cb1-6" aria-hidden="true"></a>                  <span class="st">&#39;GSE14526&#39;</span>, <span class="st">&#39;GSE4045&#39;</span>)</span>
<span id="cb1-7"><a href="load-data.html#cb1-7" aria-hidden="true"></a></span>
<span id="cb1-8"><a href="load-data.html#cb1-8" aria-hidden="true"></a> <span class="cf">for</span>(SET <span class="cf">in</span> GSE_SET.vec){</span>
<span id="cb1-9"><a href="load-data.html#cb1-9" aria-hidden="true"></a>  DnLd.tm &lt;-<span class="st"> </span><span class="kw">startTimedMessage</span>(<span class="st">&quot;Start of Download for &quot;</span>, SET)</span>
<span id="cb1-10"><a href="load-data.html#cb1-10" aria-hidden="true"></a>   Set.gse &lt;-<span class="st"> </span><span class="kw">getGEO</span>(SET, <span class="dt">destdir=</span>temp_DIR ,<span class="dt">getGPL=</span>F) </span>
<span id="cb1-11"><a href="load-data.html#cb1-11" aria-hidden="true"></a>   <span class="kw">saveObj</span>(<span class="kw">paste0</span>(SET,<span class="st">&#39;.gse&#39;</span>), <span class="st">&#39;Set.gse&#39;</span>)</span>
<span id="cb1-12"><a href="load-data.html#cb1-12" aria-hidden="true"></a>  <span class="kw">stopTimedMessage</span>(DnLd.tm)</span>
<span id="cb1-13"><a href="load-data.html#cb1-13" aria-hidden="true"></a></span>
<span id="cb1-14"><a href="load-data.html#cb1-14" aria-hidden="true"></a> }</span></code></pre></div>
<!-- ######################################################################## -->
</div>
<div id="peek-into-datasets" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Peek into Datasets</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="load-data.html#cb2-1" aria-hidden="true"></a> <span class="co"># CHANGE THIS LINE TO CLEAR CACHE </span></span>
<span id="cb2-2"><a href="load-data.html#cb2-2" aria-hidden="true"></a> <span class="kw">suppressMessages</span>(<span class="kw">require</span>(Biobase))</span>
<span id="cb2-3"><a href="load-data.html#cb2-3" aria-hidden="true"></a> gseFile.vec &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="kw">file.path</span>(<span class="st">&#39;RData&#39;</span>), <span class="st">&#39;gse$&#39;</span>)</span>
<span id="cb2-4"><a href="load-data.html#cb2-4" aria-hidden="true"></a></span>
<span id="cb2-5"><a href="load-data.html#cb2-5" aria-hidden="true"></a>gsePhenoData.lst &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb2-6"><a href="load-data.html#cb2-6" aria-hidden="true"></a>gseDim.lst &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb2-7"><a href="load-data.html#cb2-7" aria-hidden="true"></a></span>
<span id="cb2-8"><a href="load-data.html#cb2-8" aria-hidden="true"></a> <span class="cf">for</span>(gseF <span class="cf">in</span> gseFile.vec){</span>
<span id="cb2-9"><a href="load-data.html#cb2-9" aria-hidden="true"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Peek at &quot;</span>, gseF, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb2-10"><a href="load-data.html#cb2-10" aria-hidden="true"></a></span>
<span id="cb2-11"><a href="load-data.html#cb2-11" aria-hidden="true"></a>  <span class="kw">loadObj</span>(gseF, <span class="st">&#39;Set.gse&#39;</span>)</span>
<span id="cb2-12"><a href="load-data.html#cb2-12" aria-hidden="true"></a></span>
<span id="cb2-13"><a href="load-data.html#cb2-13" aria-hidden="true"></a>gseName &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">strsplit</span>(gseF, <span class="dt">split=</span><span class="st">&#39;</span><span class="ch">\\</span><span class="st">.&#39;</span>),<span class="st">&#39;[&#39;</span>,<span class="dv">1</span>)</span>
<span id="cb2-14"><a href="load-data.html#cb2-14" aria-hidden="true"></a></span>
<span id="cb2-15"><a href="load-data.html#cb2-15" aria-hidden="true"></a>  <span class="kw">print</span>(<span class="kw">dim</span>(<span class="kw">exprs</span>(Set.gse[[<span class="dv">1</span>]])))</span>
<span id="cb2-16"><a href="load-data.html#cb2-16" aria-hidden="true"></a>  <span class="cf">if</span>(<span class="kw">nrow</span>(<span class="kw">exprs</span>(Set.gse[[<span class="dv">1</span>]])) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="cf">next</span>()  </span>
<span id="cb2-17"><a href="load-data.html#cb2-17" aria-hidden="true"></a></span>
<span id="cb2-18"><a href="load-data.html#cb2-18" aria-hidden="true"></a>gseDim.lst[[gseName]] &lt;-<span class="st"> </span><span class="kw">dim</span>(<span class="kw">exprs</span>(Set.gse[[<span class="dv">1</span>]]))</span>
<span id="cb2-19"><a href="load-data.html#cb2-19" aria-hidden="true"></a></span>
<span id="cb2-20"><a href="load-data.html#cb2-20" aria-hidden="true"></a> <span class="co">#################################</span></span>
<span id="cb2-21"><a href="load-data.html#cb2-21" aria-hidden="true"></a> <span class="co"># Expression Summary </span></span>
<span id="cb2-22"><a href="load-data.html#cb2-22" aria-hidden="true"></a><span class="cf">if</span>(F) {<span class="co">#SKIP</span></span>
<span id="cb2-23"><a href="load-data.html#cb2-23" aria-hidden="true"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Expression Summary:</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-24"><a href="load-data.html#cb2-24" aria-hidden="true"></a>  knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">t</span>(<span class="kw">apply</span>(<span class="kw">exprs</span>(Set.gse[[<span class="dv">1</span>]]),<span class="dv">2</span>,summary))) <span class="op">%&gt;%</span></span>
<span id="cb2-25"><a href="load-data.html#cb2-25" aria-hidden="true"></a><span class="st">      </span>kableExtra<span class="op">::</span><span class="kw">kable_styling</span>(<span class="dt">full_width =</span> F)</span>
<span id="cb2-26"><a href="load-data.html#cb2-26" aria-hidden="true"></a></span>
<span id="cb2-27"><a href="load-data.html#cb2-27" aria-hidden="true"></a>}<span class="op">@</span>SKIP</span>
<span id="cb2-28"><a href="load-data.html#cb2-28" aria-hidden="true"></a></span>
<span id="cb2-29"><a href="load-data.html#cb2-29" aria-hidden="true"></a> <span class="co">#################################</span></span>
<span id="cb2-30"><a href="load-data.html#cb2-30" aria-hidden="true"></a> <span class="co"># Expression Boxplots</span></span>
<span id="cb2-31"><a href="load-data.html#cb2-31" aria-hidden="true"></a> old_par &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">par</span>(<span class="st">&#39;mar&#39;</span>)<span class="op">+</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb2-32"><a href="load-data.html#cb2-32" aria-hidden="true"></a></span>
<span id="cb2-33"><a href="load-data.html#cb2-33" aria-hidden="true"></a> <span class="kw">boxplot</span>(<span class="kw">exprs</span>(Set.gse[[<span class="dv">1</span>]]), <span class="dt">outline=</span>F, <span class="dt">las=</span><span class="dv">2</span>) </span>
<span id="cb2-34"><a href="load-data.html#cb2-34" aria-hidden="true"></a> <span class="kw">title</span>(<span class="kw">paste</span>(<span class="st">&quot;Boxplots of expression values for&quot;</span>, gseF))</span>
<span id="cb2-35"><a href="load-data.html#cb2-35" aria-hidden="true"></a></span>
<span id="cb2-36"><a href="load-data.html#cb2-36" aria-hidden="true"></a> <span class="kw">par</span>(old_par)</span>
<span id="cb2-37"><a href="load-data.html#cb2-37" aria-hidden="true"></a></span>
<span id="cb2-38"><a href="load-data.html#cb2-38" aria-hidden="true"></a> </span>
<span id="cb2-39"><a href="load-data.html#cb2-39" aria-hidden="true"></a> <span class="co">#################################</span></span>
<span id="cb2-40"><a href="load-data.html#cb2-40" aria-hidden="true"></a>gsePhenoData.lst[[gseName]] &lt;-<span class="st"> </span><span class="kw">phenoData</span>(Set.gse[[<span class="dv">1</span>]])<span class="op">@</span>data</span>
<span id="cb2-41"><a href="load-data.html#cb2-41" aria-hidden="true"></a></span>
<span id="cb2-42"><a href="load-data.html#cb2-42" aria-hidden="true"></a><span class="cf">if</span>(F) {<span class="co">#SKIP</span></span>
<span id="cb2-43"><a href="load-data.html#cb2-43" aria-hidden="true"></a> <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Sample Descriptions:</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-44"><a href="load-data.html#cb2-44" aria-hidden="true"></a> <span class="kw">print</span>(knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">phenoData</span>(Set.gse[[<span class="dv">1</span>]])<span class="op">@</span>data) <span class="op">%&gt;%</span></span>
<span id="cb2-45"><a href="load-data.html#cb2-45" aria-hidden="true"></a><span class="st">        </span>kableExtra<span class="op">::</span><span class="kw">kable_styling</span>(<span class="dt">full_width =</span> F))</span>
<span id="cb2-46"><a href="load-data.html#cb2-46" aria-hidden="true"></a> }</span>
<span id="cb2-47"><a href="load-data.html#cb2-47" aria-hidden="true"></a>}<span class="co">#SKIP</span></span></code></pre></div>
<pre><code>## 
## Peek at  GSE13067.gse 
## [1] 54675    74</code></pre>
<p><img src="Static/figures/load-data-peekGSE-1.png" width="1056" /></p>
<pre><code>## 
## Peek at  GSE13294.gse 
## [1] 54675   155</code></pre>
<p><img src="Static/figures/load-data-peekGSE-2.png" width="1056" /></p>
<pre><code>## 
## Peek at  GSE14526.gse 
## [1] 0 8
## 
## Peek at  GSE24514.gse 
## [1] 22283    49</code></pre>
<p><img src="Static/figures/load-data-peekGSE-3.png" width="1056" /></p>
<pre><code>## 
## Peek at  GSE26682.gse 
## [1] 19473   176</code></pre>
<p><img src="Static/figures/load-data-peekGSE-4.png" width="1056" /></p>
<pre><code>## 
## Peek at  GSE30540.gse 
## [1] 54675    35</code></pre>
<p><img src="Static/figures/load-data-peekGSE-5.png" width="1056" /></p>
<pre><code>## 
## Peek at  GSE35896.gse 
## [1] 54675    62</code></pre>
<p><img src="Static/figures/load-data-peekGSE-6.png" width="1056" /></p>
<pre><code>## 
## Peek at  GSE39084.gse 
## [1] 54675    70</code></pre>
<p><img src="Static/figures/load-data-peekGSE-7.png" width="1056" /></p>
<pre><code>## 
## Peek at  GSE4045.gse 
## [1] 22283    37</code></pre>
<p><img src="Static/figures/load-data-peekGSE-8.png" width="1056" /></p>
<pre><code>## 
## Peek at  GSE4554.gse 
## [1] 54675    84</code></pre>
<p><img src="Static/figures/load-data-peekGSE-9.png" width="1056" /></p>
<pre><code>## 
## Peek at  GSE75316.gse 
## [1] 54675    59</code></pre>
<p><img src="Static/figures/load-data-peekGSE-10.png" width="1056" />
<!-- ######################################################################## --></p>
</div>
<div id="dataset-cleaning" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Dataset Cleaning</h2>
<p>Following a peek into the datasets, we will proceed forward keeping only the
datasets which used the HG-U133_Plus_2 gene chip (N=54675 probe sets) and have
msi status:<br />
<!-- Reuires combing through gsePhenoData.lst names -->
* GSE13067, GSE13294, GSE35896, GSE39084, GSE4554</p>
<p>We exclude GSE75316 from the analysis as most of the samples are already part of GSE13067 and the latter
is a larger set.</p>
<p>In the next chunk, we go through each of these datasets and store the gene expression and
sample description data in a uniform manner to facilitate subsequent pooling. We also
take a look at potential intra dataset batch effects.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="load-data.html#cb13-1" aria-hidden="true"></a> <span class="co"># CHANGE THIS LINE TO CLEAR CACHE ..</span></span>
<span id="cb13-2"><a href="load-data.html#cb13-2" aria-hidden="true"></a> <span class="kw">suppressMessages</span>(<span class="kw">require</span>(hgu133plus2.db))</span>
<span id="cb13-3"><a href="load-data.html#cb13-3" aria-hidden="true"></a></span>
<span id="cb13-4"><a href="load-data.html#cb13-4" aria-hidden="true"></a> <span class="cf">for</span>(SET <span class="cf">in</span> KEEP_GSE.vec){</span>
<span id="cb13-5"><a href="load-data.html#cb13-5" aria-hidden="true"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n\n</span><span class="st">Processing &quot;</span>, SET, <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb13-6"><a href="load-data.html#cb13-6" aria-hidden="true"></a></span>
<span id="cb13-7"><a href="load-data.html#cb13-7" aria-hidden="true"></a>  <span class="kw">loadObj</span>(<span class="kw">paste0</span>(SET, <span class="st">&#39;.gse&#39;</span>), <span class="st">&#39;Set.gse&#39;</span>)</span>
<span id="cb13-8"><a href="load-data.html#cb13-8" aria-hidden="true"></a></span>
<span id="cb13-9"><a href="load-data.html#cb13-9" aria-hidden="true"></a>  <span class="co">###################################################################</span></span>
<span id="cb13-10"><a href="load-data.html#cb13-10" aria-hidden="true"></a>  <span class="co">#  Expr - matrix</span></span>
<span id="cb13-11"><a href="load-data.html#cb13-11" aria-hidden="true"></a>  <span class="co">#  - rows are features</span></span>
<span id="cb13-12"><a href="load-data.html#cb13-12" aria-hidden="true"></a>  <span class="co">#  - columns are samples</span></span>
<span id="cb13-13"><a href="load-data.html#cb13-13" aria-hidden="true"></a>  <span class="co">###################################################################</span></span>
<span id="cb13-14"><a href="load-data.html#cb13-14" aria-hidden="true"></a>  Expr.mtx &lt;-<span class="st"> </span><span class="kw">exprs</span>(Set.gse[[<span class="dv">1</span>]])</span>
<span id="cb13-15"><a href="load-data.html#cb13-15" aria-hidden="true"></a></span>
<span id="cb13-16"><a href="load-data.html#cb13-16" aria-hidden="true"></a>  <span class="cf">if</span>(SET <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;GSE4554&#39;</span>, <span class="st">&#39;GSE4045&#39;</span>))  Expr.mtx &lt;-<span class="st"> </span><span class="kw">log2</span>(<span class="kw">pmax</span>(Expr.mtx, <span class="kw">min</span>(Expr.mtx[Expr.mtx<span class="op">&gt;</span><span class="dv">0</span>])))</span>
<span id="cb13-17"><a href="load-data.html#cb13-17" aria-hidden="true"></a></span>
<span id="cb13-18"><a href="load-data.html#cb13-18" aria-hidden="true"></a>  <span class="co">###################################################################</span></span>
<span id="cb13-19"><a href="load-data.html#cb13-19" aria-hidden="true"></a>  <span class="co">#  SampAttr - data.frame</span></span>
<span id="cb13-20"><a href="load-data.html#cb13-20" aria-hidden="true"></a>  <span class="co">#  - rows are samples</span></span>
<span id="cb13-21"><a href="load-data.html#cb13-21" aria-hidden="true"></a>  <span class="co">#  - columns are atttibutes of the samples</span></span>
<span id="cb13-22"><a href="load-data.html#cb13-22" aria-hidden="true"></a>  <span class="co">###################################################################</span></span>
<span id="cb13-23"><a href="load-data.html#cb13-23" aria-hidden="true"></a>  phenoData.frm &lt;-<span class="st"> </span><span class="kw">phenoData</span>(Set.gse[[<span class="dv">1</span>]])<span class="op">@</span>data</span>
<span id="cb13-24"><a href="load-data.html#cb13-24" aria-hidden="true"></a></span>
<span id="cb13-25"><a href="load-data.html#cb13-25" aria-hidden="true"></a>  <span class="cf">if</span>(<span class="kw">nrow</span>(phenoData.frm) <span class="op">!=</span><span class="st"> </span><span class="kw">ncol</span>(Expr.mtx)) <span class="kw">stop</span>(<span class="st">&quot;Expression-sampAttr Mismatch for &quot;</span>, SET)</span>
<span id="cb13-26"><a href="load-data.html#cb13-26" aria-hidden="true"></a></span>
<span id="cb13-27"><a href="load-data.html#cb13-27" aria-hidden="true"></a>  MS_Status &lt;-<span class="st"> </span><span class="cf">switch</span>(SET,</span>
<span id="cb13-28"><a href="load-data.html#cb13-28" aria-hidden="true"></a>      <span class="dt">GSE13067 =</span> <span class="kw">gsub</span>(<span class="st">&#39; &#39;</span>,<span class="st">&#39;&#39;</span>, </span>
<span id="cb13-29"><a href="load-data.html#cb13-29" aria-hidden="true"></a>                 <span class="kw">sapply</span>(<span class="kw">strsplit</span>(phenoData.frm<span class="op">$</span>title, <span class="dt">split=</span><span class="st">&#39;:&#39;</span>), <span class="cf">function</span>(x) x[<span class="dv">2</span>])), </span>
<span id="cb13-30"><a href="load-data.html#cb13-30" aria-hidden="true"></a>      <span class="dt">GSE13294 =</span> <span class="kw">gsub</span>(<span class="st">&#39; &#39;</span>,<span class="st">&#39;&#39;</span>, </span>
<span id="cb13-31"><a href="load-data.html#cb13-31" aria-hidden="true"></a>                 <span class="kw">sapply</span>(<span class="kw">strsplit</span>(phenoData.frm<span class="op">$</span>title, <span class="dt">split=</span><span class="st">&#39;:&#39;</span>), <span class="cf">function</span>(x) x[<span class="dv">2</span>])), </span>
<span id="cb13-32"><a href="load-data.html#cb13-32" aria-hidden="true"></a>      <span class="dt">GSE35896 =</span> <span class="kw">gsub</span>(<span class="st">&#39; &#39;</span>,<span class="st">&#39;&#39;</span>, </span>
<span id="cb13-33"><a href="load-data.html#cb13-33" aria-hidden="true"></a>                 <span class="kw">sapply</span>(<span class="kw">strsplit</span>(phenoData.frm<span class="op">$</span>characteristics_ch1<span class="fl">.7</span>, <span class="dt">split=</span><span class="st">&#39;:&#39;</span>), <span class="cf">function</span>(x) x[<span class="dv">2</span>])), </span>
<span id="cb13-34"><a href="load-data.html#cb13-34" aria-hidden="true"></a>      <span class="dt">GSE39084 =</span> <span class="kw">gsub</span>(<span class="st">&#39; &#39;</span>,<span class="st">&#39;&#39;</span>, </span>
<span id="cb13-35"><a href="load-data.html#cb13-35" aria-hidden="true"></a>                 <span class="kw">sapply</span>(<span class="kw">strsplit</span>(phenoData.frm<span class="op">$</span>characteristics_ch1<span class="fl">.16</span>, <span class="dt">split=</span><span class="st">&#39;:&#39;</span>), <span class="cf">function</span>(x) x[<span class="dv">2</span>])), </span>
<span id="cb13-36"><a href="load-data.html#cb13-36" aria-hidden="true"></a>      <span class="dt">GSE4554 =</span>  <span class="kw">gsub</span>(<span class="st">&#39; &#39;</span>, <span class="st">&#39;&#39;</span>,</span>
<span id="cb13-37"><a href="load-data.html#cb13-37" aria-hidden="true"></a>                 <span class="kw">sapply</span>(<span class="kw">strsplit</span>(<span class="kw">as.character</span>(phenoData.frm<span class="op">$</span>description), <span class="dt">split=</span><span class="st">&#39;,&#39;</span>), <span class="cf">function</span>(x) x[<span class="dv">1</span>])),</span>
<span id="cb13-38"><a href="load-data.html#cb13-38" aria-hidden="true"></a>        <span class="st">&quot;ERROR&quot;</span>)</span>
<span id="cb13-39"><a href="load-data.html#cb13-39" aria-hidden="true"></a></span>
<span id="cb13-40"><a href="load-data.html#cb13-40" aria-hidden="true"></a></span>
<span id="cb13-41"><a href="load-data.html#cb13-41" aria-hidden="true"></a>  KEEP.ndx &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">is.element</span>(MS_Status, <span class="kw">c</span>(<span class="st">&#39;MSS&#39;</span>, <span class="st">&#39;MSI&#39;</span>, <span class="st">&#39;No&#39;</span>, <span class="st">&#39;Low&#39;</span>, <span class="st">&#39;High&#39;</span>)))</span>
<span id="cb13-42"><a href="load-data.html#cb13-42" aria-hidden="true"></a></span>
<span id="cb13-43"><a href="load-data.html#cb13-43" aria-hidden="true"></a>  sampAttr.frm &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Sample_Id=</span><span class="kw">rownames</span>(phenoData.frm),</span>
<span id="cb13-44"><a href="load-data.html#cb13-44" aria-hidden="true"></a>                             <span class="dt">MS_Status=</span>MS_Status, </span>
<span id="cb13-45"><a href="load-data.html#cb13-45" aria-hidden="true"></a>                             <span class="dt">row.names=</span><span class="kw">rownames</span>(phenoData.frm))[KEEP.ndx,]</span>
<span id="cb13-46"><a href="load-data.html#cb13-46" aria-hidden="true"></a>  Expr.mtx &lt;-<span class="st"> </span>Expr.mtx[,<span class="kw">rownames</span>(sampAttr.frm)]</span>
<span id="cb13-47"><a href="load-data.html#cb13-47" aria-hidden="true"></a> </span>
<span id="cb13-48"><a href="load-data.html#cb13-48" aria-hidden="true"></a>  <span class="kw">print</span>(<span class="kw">table</span>(MS_Status[KEEP.ndx]))</span>
<span id="cb13-49"><a href="load-data.html#cb13-49" aria-hidden="true"></a></span>
<span id="cb13-50"><a href="load-data.html#cb13-50" aria-hidden="true"></a>  <span class="co">###################################################################</span></span>
<span id="cb13-51"><a href="load-data.html#cb13-51" aria-hidden="true"></a>  <span class="co">#  featureAttr - data.frame</span></span>
<span id="cb13-52"><a href="load-data.html#cb13-52" aria-hidden="true"></a>  <span class="co">#  - rows of featureAttr match rows of Expr mtx</span></span>
<span id="cb13-53"><a href="load-data.html#cb13-53" aria-hidden="true"></a>  <span class="co">#  - columns of featureAttr are atttibutes of the features - eg geneSymbol</span></span>
<span id="cb13-54"><a href="load-data.html#cb13-54" aria-hidden="true"></a>  <span class="co">###################################################################</span></span>
<span id="cb13-55"><a href="load-data.html#cb13-55" aria-hidden="true"></a>  <span class="co"># This deosn;t work!</span></span>
<span id="cb13-56"><a href="load-data.html#cb13-56" aria-hidden="true"></a>  <span class="co">#featureAttr.frm &lt;- featureData(Set.gse[[1]])@data</span></span>
<span id="cb13-57"><a href="load-data.html#cb13-57" aria-hidden="true"></a>  <span class="co">#dim(featureAttr.frm)</span></span>
<span id="cb13-58"><a href="load-data.html#cb13-58" aria-hidden="true"></a>  <span class="co">#Symbol.vec &lt;- mget(featureAttr.frm$ID, hgu133plus2SYMBOL)</span></span>
<span id="cb13-59"><a href="load-data.html#cb13-59" aria-hidden="true"></a>  <span class="co">#featureAttr.frm$Symbol &lt;- Symbol.vec[rownames(featureAttr.frm)]</span></span>
<span id="cb13-60"><a href="load-data.html#cb13-60" aria-hidden="true"></a> </span>
<span id="cb13-61"><a href="load-data.html#cb13-61" aria-hidden="true"></a>  Symbol.vec &lt;-<span class="st"> </span><span class="kw">mget</span>(<span class="kw">rownames</span>(Expr.mtx), hgu133plus2SYMBOL)</span>
<span id="cb13-62"><a href="load-data.html#cb13-62" aria-hidden="true"></a>  featureAttr.frm &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Symbol=</span><span class="kw">unlist</span>(Symbol.vec))</span>
<span id="cb13-63"><a href="load-data.html#cb13-63" aria-hidden="true"></a>  <span class="kw">rownames</span>(featureAttr.frm) &lt;-<span class="st"> </span><span class="kw">rownames</span>(Expr.mtx)</span>
<span id="cb13-64"><a href="load-data.html#cb13-64" aria-hidden="true"></a> </span>
<span id="cb13-65"><a href="load-data.html#cb13-65" aria-hidden="true"></a>  <span class="co">###################################################</span></span>
<span id="cb13-66"><a href="load-data.html#cb13-66" aria-hidden="true"></a>  <span class="co"># Save in arrayGeneExpr object</span></span>
<span id="cb13-67"><a href="load-data.html#cb13-67" aria-hidden="true"></a>  <span class="co">###################################################</span></span>
<span id="cb13-68"><a href="load-data.html#cb13-68" aria-hidden="true"></a>  <span class="cf">if</span>(<span class="kw">sum</span>(<span class="kw">colnames</span>(Expr.mtx) <span class="op">!=</span><span class="st"> </span><span class="kw">rownames</span>(sampAttr.frm))) <span class="kw">stop</span>(<span class="st">&quot;Column order error&quot;</span>)</span>
<span id="cb13-69"><a href="load-data.html#cb13-69" aria-hidden="true"></a>  <span class="cf">if</span>(<span class="kw">sum</span>(<span class="kw">rownames</span>(Expr.mtx) <span class="op">!=</span><span class="st"> </span><span class="kw">rownames</span>(featureAttr.frm))) <span class="kw">stop</span>(<span class="st">&quot;Row order error&quot;</span>)</span>
<span id="cb13-70"><a href="load-data.html#cb13-70" aria-hidden="true"></a> </span>
<span id="cb13-71"><a href="load-data.html#cb13-71" aria-hidden="true"></a>  Set.arrayGeneExpr &lt;-<span class="st">  </span><span class="kw">list</span>(<span class="dt">exprData=</span><span class="ot">NA</span>, <span class="dt">exprType=</span><span class="ot">NA</span>, <span class="dt">Norm=</span><span class="ot">NA</span>,</span>
<span id="cb13-72"><a href="load-data.html#cb13-72" aria-hidden="true"></a>                                   <span class="dt">sampAttr=</span><span class="ot">NA</span>, <span class="dt">featureAttr=</span><span class="ot">NA</span>)</span>
<span id="cb13-73"><a href="load-data.html#cb13-73" aria-hidden="true"></a>  <span class="kw">class</span>(Set.arrayGeneExpr) &lt;-<span class="st"> &quot;arrayGeneExpr&quot;</span></span>
<span id="cb13-74"><a href="load-data.html#cb13-74" aria-hidden="true"></a>  Set.arrayGeneExpr<span class="op">$</span>exprData &lt;-<span class="st"> </span>Expr.mtx</span>
<span id="cb13-75"><a href="load-data.html#cb13-75" aria-hidden="true"></a>  Set.arrayGeneExpr<span class="op">$</span>sampAttr &lt;-<span class="st"> </span>sampAttr.frm</span>
<span id="cb13-76"><a href="load-data.html#cb13-76" aria-hidden="true"></a>  Set.arrayGeneExpr<span class="op">$</span>featureAttr &lt;-<span class="st"> </span>featureAttr.frm</span>
<span id="cb13-77"><a href="load-data.html#cb13-77" aria-hidden="true"></a> </span>
<span id="cb13-78"><a href="load-data.html#cb13-78" aria-hidden="true"></a>  <span class="kw">saveObj</span>(<span class="kw">paste0</span>(SET,<span class="st">&#39;.arrayGeneExpr&#39;</span>), <span class="st">&#39;Set.arrayGeneExpr&#39;</span>)</span>
<span id="cb13-79"><a href="load-data.html#cb13-79" aria-hidden="true"></a> </span>
<span id="cb13-80"><a href="load-data.html#cb13-80" aria-hidden="true"></a>  <span class="co">######################################################</span></span>
<span id="cb13-81"><a href="load-data.html#cb13-81" aria-hidden="true"></a>  <span class="co"># Look for intra-set batch effects</span></span>
<span id="cb13-82"><a href="load-data.html#cb13-82" aria-hidden="true"></a>  <span class="co">######################################################</span></span>
<span id="cb13-83"><a href="load-data.html#cb13-83" aria-hidden="true"></a>  Expt.prcomp &lt;-<span class="st"> </span><span class="kw">prcomp</span>(Expr.mtx)</span>
<span id="cb13-84"><a href="load-data.html#cb13-84" aria-hidden="true"></a>  </span>
<span id="cb13-85"><a href="load-data.html#cb13-85" aria-hidden="true"></a>  <span class="kw">plot</span>(<span class="dt">x=</span>Expt.prcomp<span class="op">$</span>rotation[,<span class="st">&#39;PC1&#39;</span>],</span>
<span id="cb13-86"><a href="load-data.html#cb13-86" aria-hidden="true"></a>       <span class="dt">xlab=</span><span class="kw">paste0</span>(<span class="st">&#39;PC1 (&#39;</span>, <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">summary</span>(Expt.prcomp)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="st">&quot;PC1&quot;</span>],<span class="dv">1</span>),<span class="st">&#39;%)&#39;</span>),</span>
<span id="cb13-87"><a href="load-data.html#cb13-87" aria-hidden="true"></a>       <span class="dt">y=</span>Expt.prcomp<span class="op">$</span>rotation[,<span class="st">&#39;PC2&#39;</span>],</span>
<span id="cb13-88"><a href="load-data.html#cb13-88" aria-hidden="true"></a>       <span class="dt">ylab=</span><span class="kw">paste0</span>(<span class="st">&#39;PC2 (&#39;</span>, <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">summary</span>(Expt.prcomp)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="st">&quot;PC2&quot;</span>],<span class="dv">1</span>),<span class="st">&#39;%)&#39;</span>),</span>
<span id="cb13-89"><a href="load-data.html#cb13-89" aria-hidden="true"></a>       <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, <span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(sampAttr.frm<span class="op">$</span>MS_Status)))</span>
<span id="cb13-90"><a href="load-data.html#cb13-90" aria-hidden="true"></a>  <span class="kw">title</span>(SET) </span>
<span id="cb13-91"><a href="load-data.html#cb13-91" aria-hidden="true"></a>  <span class="kw">legend</span>(<span class="kw">ifelse</span>(SET <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;GSE13067&#39;</span>, <span class="st">&#39;GSE35896&#39;</span>), <span class="st">&#39;bottomleft&#39;</span>, <span class="st">&#39;bottomright&#39;</span>),</span>
<span id="cb13-92"><a href="load-data.html#cb13-92" aria-hidden="true"></a>  <span class="dt">legend=</span><span class="kw">levels</span>(<span class="kw">as.factor</span>(sampAttr.frm<span class="op">$</span>MS_Status)),</span>
<span id="cb13-93"><a href="load-data.html#cb13-93" aria-hidden="true"></a>  <span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">levels</span>(<span class="kw">as.factor</span>(sampAttr.frm<span class="op">$</span>MS_Status))),</span>
<span id="cb13-94"><a href="load-data.html#cb13-94" aria-hidden="true"></a>  <span class="dt">pch=</span><span class="dv">19</span>)</span>
<span id="cb13-95"><a href="load-data.html#cb13-95" aria-hidden="true"></a> </span>
<span id="cb13-96"><a href="load-data.html#cb13-96" aria-hidden="true"></a> } </span></code></pre></div>
<pre><code>## 
## 
## Processing  GSE13067 
## 
## MSI MSS 
##  11  63</code></pre>
<p><img src="Static/figures/load-data-cleanGSE-1.png" width="768" /></p>
<pre><code>## 
## 
## Processing  GSE13294 
## 
## MSI MSS 
##  78  77</code></pre>
<p><img src="Static/figures/load-data-cleanGSE-2.png" width="768" /></p>
<pre><code>## 
## 
## Processing  GSE35896 
## 
## MSI MSS 
##   5  56</code></pre>
<p><img src="Static/figures/load-data-cleanGSE-3.png" width="768" /></p>
<pre><code>## 
## 
## Processing  GSE39084 
## 
## High  Low   No 
##   16    3   51</code></pre>
<p><img src="Static/figures/load-data-cleanGSE-4.png" width="768" /></p>
<pre><code>## 
## 
## Processing  GSE4554 
## 
## MSI MSS 
##  33  50</code></pre>
<p><img src="Static/figures/load-data-cleanGSE-5.png" width="768" />
<!-- ######################################################################## --></p>
</div>
<div id="data-pooling" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Data Pooling</h2>
<p>When pooling data from different sources, we should make sure not to introduce batch effects
into the mix. In the first instance we will simply pool the data sets together,
and apply quantile normalization. This can be seen as a very weak form of batch effect
correction and is a minimal requirement. For a more careful way to remove batch effects
and other unwanted variation see
Gagnon-Bartsch (2012) <span class="citation">[<a href="#ref-Gagnon-Bartsch:2012aa" role="doc-biblioref">5</a>]</span> and
Molania et al. (2019) <span class="citation">[<a href="#ref-Molania:2019aa" role="doc-biblioref">6</a>]</span>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="load-data.html#cb19-1" aria-hidden="true"></a> <span class="co">###############################</span></span>
<span id="cb19-2"><a href="load-data.html#cb19-2" aria-hidden="true"></a> <span class="co"># Get feature attributes from one of the arrayGeneExpr objects</span></span>
<span id="cb19-3"><a href="load-data.html#cb19-3" aria-hidden="true"></a> <span class="co">###############################</span></span>
<span id="cb19-4"><a href="load-data.html#cb19-4" aria-hidden="true"></a> <span class="kw">loadObj</span>(<span class="kw">paste0</span>(KEEP_GSE.vec[<span class="dv">1</span>],<span class="st">&#39;.arrayGeneExpr&#39;</span>), <span class="st">&#39;Set.arrayGeneExpr&#39;</span>)</span>
<span id="cb19-5"><a href="load-data.html#cb19-5" aria-hidden="true"></a></span>
<span id="cb19-6"><a href="load-data.html#cb19-6" aria-hidden="true"></a> featureAttr.frm &lt;-<span class="st"> </span>Set.arrayGeneExpr<span class="op">$</span>featureAttr</span>
<span id="cb19-7"><a href="load-data.html#cb19-7" aria-hidden="true"></a> featureAttr.frm<span class="op">$</span>Symbol[<span class="kw">is.na</span>(featureAttr.frm<span class="op">$</span>Symbol)] &lt;-</span>
<span id="cb19-8"><a href="load-data.html#cb19-8" aria-hidden="true"></a><span class="st">        </span><span class="kw">rownames</span>(featureAttr.frm)[<span class="kw">is.na</span>(featureAttr.frm<span class="op">$</span>Symbol)]</span>
<span id="cb19-9"><a href="load-data.html#cb19-9" aria-hidden="true"></a> featureAttr.frm[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,,drop=F]</span></code></pre></div>
<pre><code>##              Symbol
## 1007_s_at 1007_s_at
## 1053_at        RFC2
## 117_at        HSPA6
## 121_at         PAX8
## 1255_g_at    GUCA1A</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="load-data.html#cb21-1" aria-hidden="true"></a> geneId.vec &lt;-<span class="st"> </span><span class="kw">rownames</span>(featureAttr.frm)</span>
<span id="cb21-2"><a href="load-data.html#cb21-2" aria-hidden="true"></a></span>
<span id="cb21-3"><a href="load-data.html#cb21-3" aria-hidden="true"></a> <span class="co">###############################</span></span>
<span id="cb21-4"><a href="load-data.html#cb21-4" aria-hidden="true"></a></span>
<span id="cb21-5"><a href="load-data.html#cb21-5" aria-hidden="true"></a> <span class="co">###############################</span></span>
<span id="cb21-6"><a href="load-data.html#cb21-6" aria-hidden="true"></a> <span class="co"># Pool the expression data</span></span>
<span id="cb21-7"><a href="load-data.html#cb21-7" aria-hidden="true"></a> <span class="co">###############################</span></span>
<span id="cb21-8"><a href="load-data.html#cb21-8" aria-hidden="true"></a> PooledExpr.mtx &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&#39;cbind&#39;</span>, <span class="kw">lapply</span>(KEEP_GSE.vec,</span>
<span id="cb21-9"><a href="load-data.html#cb21-9" aria-hidden="true"></a>  <span class="cf">function</span>(SET) {</span>
<span id="cb21-10"><a href="load-data.html#cb21-10" aria-hidden="true"></a>    <span class="kw">loadObj</span>(<span class="kw">paste0</span>(SET,<span class="st">&#39;.arrayGeneExpr&#39;</span>), <span class="st">&#39;Set.arrayGeneExpr&#39;</span>)</span>
<span id="cb21-11"><a href="load-data.html#cb21-11" aria-hidden="true"></a>    Set.arrayGeneExpr<span class="op">$</span>exprData[geneId.vec,]</span>
<span id="cb21-12"><a href="load-data.html#cb21-12" aria-hidden="true"></a> }))</span>
<span id="cb21-13"><a href="load-data.html#cb21-13" aria-hidden="true"></a></span>
<span id="cb21-14"><a href="load-data.html#cb21-14" aria-hidden="true"></a> <span class="co">#dim(PooledExpr.mtx)</span></span>
<span id="cb21-15"><a href="load-data.html#cb21-15" aria-hidden="true"></a> <span class="co">#PooledExpr.mtx[1:5, 1:5]</span></span>
<span id="cb21-16"><a href="load-data.html#cb21-16" aria-hidden="true"></a></span>
<span id="cb21-17"><a href="load-data.html#cb21-17" aria-hidden="true"></a> <span class="co"># Apply quantile normalization</span></span>
<span id="cb21-18"><a href="load-data.html#cb21-18" aria-hidden="true"></a> median.Expr.vec &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="kw">apply</span>(PooledExpr.mtx,<span class="dv">2</span>,sort), <span class="dv">1</span>, median)</span>
<span id="cb21-19"><a href="load-data.html#cb21-19" aria-hidden="true"></a> <span class="co">#summary(median.Expr.vec)</span></span>
<span id="cb21-20"><a href="load-data.html#cb21-20" aria-hidden="true"></a></span>
<span id="cb21-21"><a href="load-data.html#cb21-21" aria-hidden="true"></a> PooledNormedExpr.mtx &lt;-<span class="st"> </span><span class="kw">apply</span>(PooledExpr.mtx, <span class="dv">2</span>, <span class="cf">function</span>(x)</span>
<span id="cb21-22"><a href="load-data.html#cb21-22" aria-hidden="true"></a>     median.Expr.vec[<span class="kw">rank</span>(x)])</span>
<span id="cb21-23"><a href="load-data.html#cb21-23" aria-hidden="true"></a> <span class="kw">rownames</span>(PooledNormedExpr.mtx) &lt;-<span class="st"> </span><span class="kw">rownames</span>(PooledExpr.mtx)</span>
<span id="cb21-24"><a href="load-data.html#cb21-24" aria-hidden="true"></a></span>
<span id="cb21-25"><a href="load-data.html#cb21-25" aria-hidden="true"></a></span>
<span id="cb21-26"><a href="load-data.html#cb21-26" aria-hidden="true"></a> <span class="co">#summary(apply(PooledExpr.mtx, 2, mean))</span></span>
<span id="cb21-27"><a href="load-data.html#cb21-27" aria-hidden="true"></a> <span class="co">#summary(apply(PooledNormedExpr.mtx, 2, mean))</span></span>
<span id="cb21-28"><a href="load-data.html#cb21-28" aria-hidden="true"></a></span>
<span id="cb21-29"><a href="load-data.html#cb21-29" aria-hidden="true"></a> <span class="co">###############################</span></span>
<span id="cb21-30"><a href="load-data.html#cb21-30" aria-hidden="true"></a> <span class="co"># Pool the sample attribute data</span></span>
<span id="cb21-31"><a href="load-data.html#cb21-31" aria-hidden="true"></a> <span class="co">###############################</span></span>
<span id="cb21-32"><a href="load-data.html#cb21-32" aria-hidden="true"></a> PooledSampAttr.frm &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&#39;rbind&#39;</span>, <span class="kw">lapply</span>(KEEP_GSE.vec,</span>
<span id="cb21-33"><a href="load-data.html#cb21-33" aria-hidden="true"></a>  <span class="cf">function</span>(SET) {</span>
<span id="cb21-34"><a href="load-data.html#cb21-34" aria-hidden="true"></a>   <span class="co">#cat(SET,&#39;\n&#39;)</span></span>
<span id="cb21-35"><a href="load-data.html#cb21-35" aria-hidden="true"></a>    <span class="kw">loadObj</span>(<span class="kw">paste0</span>(SET,<span class="st">&#39;.arrayGeneExpr&#39;</span>), <span class="st">&#39;Set.arrayGeneExpr&#39;</span>)</span>
<span id="cb21-36"><a href="load-data.html#cb21-36" aria-hidden="true"></a>    <span class="kw">data.frame</span>(<span class="dt">GSE=</span><span class="kw">rep</span>(SET,<span class="kw">nrow</span>(Set.arrayGeneExpr<span class="op">$</span>sampAttr)),</span>
<span id="cb21-37"><a href="load-data.html#cb21-37" aria-hidden="true"></a>               <span class="dt">Sample_Id=</span>Set.arrayGeneExpr<span class="op">$</span>sampAttr<span class="op">$</span>Sample_Id,</span>
<span id="cb21-38"><a href="load-data.html#cb21-38" aria-hidden="true"></a>               <span class="dt">MS_Status=</span>Set.arrayGeneExpr<span class="op">$</span>sampAttr<span class="op">$</span>MS_Status,</span>
<span id="cb21-39"><a href="load-data.html#cb21-39" aria-hidden="true"></a>               <span class="dt">row.names=</span><span class="kw">rownames</span>(Set.arrayGeneExpr<span class="op">$</span>sampAttr))</span>
<span id="cb21-40"><a href="load-data.html#cb21-40" aria-hidden="true"></a>  }))</span>
<span id="cb21-41"><a href="load-data.html#cb21-41" aria-hidden="true"></a></span>
<span id="cb21-42"><a href="load-data.html#cb21-42" aria-hidden="true"></a> <span class="co">#dim(PooledSampAttr.frm)</span></span>
<span id="cb21-43"><a href="load-data.html#cb21-43" aria-hidden="true"></a> <span class="co">#PooledSampAttr.frm[1:5, ]</span></span>
<span id="cb21-44"><a href="load-data.html#cb21-44" aria-hidden="true"></a></span>
<span id="cb21-45"><a href="load-data.html#cb21-45" aria-hidden="true"></a> <span class="co"># Assemble arrayGeneExpr object for pooled data and save</span></span>
<span id="cb21-46"><a href="load-data.html#cb21-46" aria-hidden="true"></a> GSEPool.arrayGeneExpr &lt;-<span class="st">  </span><span class="kw">list</span>(<span class="dt">exprData=</span><span class="ot">NA</span>, <span class="dt">exprType=</span><span class="ot">NA</span>, <span class="dt">Norm=</span><span class="ot">NA</span>,</span>
<span id="cb21-47"><a href="load-data.html#cb21-47" aria-hidden="true"></a>                                  <span class="dt">sampAttr=</span><span class="ot">NA</span>, <span class="dt">featureAttr=</span><span class="ot">NA</span>)</span>
<span id="cb21-48"><a href="load-data.html#cb21-48" aria-hidden="true"></a> <span class="kw">class</span>(GSEPool.arrayGeneExpr) &lt;-<span class="st"> &quot;arrayGeneExpr&quot;</span></span>
<span id="cb21-49"><a href="load-data.html#cb21-49" aria-hidden="true"></a> GSEPool.arrayGeneExpr<span class="op">$</span>exprData &lt;-<span class="st"> </span>PooledNormedExpr.mtx</span>
<span id="cb21-50"><a href="load-data.html#cb21-50" aria-hidden="true"></a> GSEPool.arrayGeneExpr<span class="op">$</span>exprType &lt;-<span class="st"> &#39;MAS5_RMA&#39;</span></span>
<span id="cb21-51"><a href="load-data.html#cb21-51" aria-hidden="true"></a> GSEPool.arrayGeneExpr<span class="op">$</span>Norm &lt;-<span class="st"> &#39;Quantile&#39;</span></span>
<span id="cb21-52"><a href="load-data.html#cb21-52" aria-hidden="true"></a> GSEPool.arrayGeneExpr<span class="op">$</span>sampAttr &lt;-<span class="st"> </span>PooledSampAttr.frm</span>
<span id="cb21-53"><a href="load-data.html#cb21-53" aria-hidden="true"></a> GSEPool.arrayGeneExpr<span class="op">$</span>featureAttr &lt;-<span class="st"> </span>featureAttr.frm</span>
<span id="cb21-54"><a href="load-data.html#cb21-54" aria-hidden="true"></a></span>
<span id="cb21-55"><a href="load-data.html#cb21-55" aria-hidden="true"></a> <span class="kw">save</span>(GSEPool.arrayGeneExpr, <span class="dt">file=</span><span class="kw">file.path</span>(<span class="st">&#39;RData&#39;</span>,<span class="st">&#39;GSEPool.arrayGeneExpr&#39;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="load-data.html#cb22-1" aria-hidden="true"></a> <span class="kw">loadObj</span>(<span class="st">&#39;GSEPool.arrayGeneExpr&#39;</span>, <span class="st">&#39;GSEPool.arrayGeneExpr&#39;</span>)</span>
<span id="cb22-2"><a href="load-data.html#cb22-2" aria-hidden="true"></a> PooledNormedExpr.mtx &lt;-<span class="st"> </span>GSEPool.arrayGeneExpr<span class="op">$</span>exprData</span>
<span id="cb22-3"><a href="load-data.html#cb22-3" aria-hidden="true"></a></span>
<span id="cb22-4"><a href="load-data.html#cb22-4" aria-hidden="true"></a> <span class="co">######################################################</span></span>
<span id="cb22-5"><a href="load-data.html#cb22-5" aria-hidden="true"></a> <span class="co"># Look for inter-set batch effects</span></span>
<span id="cb22-6"><a href="load-data.html#cb22-6" aria-hidden="true"></a> <span class="co">######################################################</span></span>
<span id="cb22-7"><a href="load-data.html#cb22-7" aria-hidden="true"></a> Expt.prcomp &lt;-<span class="st"> </span><span class="kw">prcomp</span>(PooledNormedExpr.mtx)</span>
<span id="cb22-8"><a href="load-data.html#cb22-8" aria-hidden="true"></a>  </span>
<span id="cb22-9"><a href="load-data.html#cb22-9" aria-hidden="true"></a> <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>))</span>
<span id="cb22-10"><a href="load-data.html#cb22-10" aria-hidden="true"></a> <span class="co"># Annotate with Batch</span></span>
<span id="cb22-11"><a href="load-data.html#cb22-11" aria-hidden="true"></a> <span class="kw">plot</span>(<span class="dt">x=</span>Expt.prcomp<span class="op">$</span>rotation[,<span class="st">&#39;PC1&#39;</span>],</span>
<span id="cb22-12"><a href="load-data.html#cb22-12" aria-hidden="true"></a>      <span class="dt">xlab=</span><span class="kw">paste0</span>(<span class="st">&#39;PC1 (&#39;</span>, <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">summary</span>(Expt.prcomp)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="st">&quot;PC1&quot;</span>],<span class="dv">1</span>),<span class="st">&#39;%)&#39;</span>),</span>
<span id="cb22-13"><a href="load-data.html#cb22-13" aria-hidden="true"></a>      <span class="dt">y=</span>Expt.prcomp<span class="op">$</span>rotation[,<span class="st">&#39;PC2&#39;</span>],</span>
<span id="cb22-14"><a href="load-data.html#cb22-14" aria-hidden="true"></a>      <span class="dt">ylab=</span><span class="kw">paste0</span>(<span class="st">&#39;PC2 (&#39;</span>, <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">summary</span>(Expt.prcomp)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="st">&quot;PC2&quot;</span>],<span class="dv">1</span>),<span class="st">&#39;%)&#39;</span>),</span>
<span id="cb22-15"><a href="load-data.html#cb22-15" aria-hidden="true"></a>      <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, <span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(PooledSampAttr.frm<span class="op">$</span>GSE)))</span>
<span id="cb22-16"><a href="load-data.html#cb22-16" aria-hidden="true"></a> <span class="kw">title</span>(<span class="st">&#39;Color is Batch&#39;</span>)</span>
<span id="cb22-17"><a href="load-data.html#cb22-17" aria-hidden="true"></a></span>
<span id="cb22-18"><a href="load-data.html#cb22-18" aria-hidden="true"></a> legend.tbl &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="kw">as.factor</span>(PooledSampAttr.frm<span class="op">$</span>GSE), </span>
<span id="cb22-19"><a href="load-data.html#cb22-19" aria-hidden="true"></a>                     <span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(PooledSampAttr.frm<span class="op">$</span>GSE)))</span>
<span id="cb22-20"><a href="load-data.html#cb22-20" aria-hidden="true"></a> <span class="kw">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, </span>
<span id="cb22-21"><a href="load-data.html#cb22-21" aria-hidden="true"></a>         <span class="dt">legend=</span><span class="kw">rownames</span>(legend.tbl),</span>
<span id="cb22-22"><a href="load-data.html#cb22-22" aria-hidden="true"></a>         <span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">colnames</span>(legend.tbl)))</span>
<span id="cb22-23"><a href="load-data.html#cb22-23" aria-hidden="true"></a></span>
<span id="cb22-24"><a href="load-data.html#cb22-24" aria-hidden="true"></a> <span class="co"># Annotate with MS_Status</span></span>
<span id="cb22-25"><a href="load-data.html#cb22-25" aria-hidden="true"></a> MSS_MSI &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">ifelse</span>(<span class="kw">is.element</span>(PooledSampAttr.frm<span class="op">$</span>MS_Status, <span class="kw">c</span>(<span class="st">&#39;MSS&#39;</span>, <span class="st">&#39;No&#39;</span>)),</span>
<span id="cb22-26"><a href="load-data.html#cb22-26" aria-hidden="true"></a>          <span class="st">&#39;MSS&#39;</span>,<span class="st">&#39;MSI&#39;</span>))</span>
<span id="cb22-27"><a href="load-data.html#cb22-27" aria-hidden="true"></a> <span class="kw">plot</span>(<span class="dt">x=</span>Expt.prcomp<span class="op">$</span>rotation[,<span class="st">&#39;PC1&#39;</span>],</span>
<span id="cb22-28"><a href="load-data.html#cb22-28" aria-hidden="true"></a>      <span class="dt">xlab=</span><span class="kw">paste0</span>(<span class="st">&#39;PC1 (&#39;</span>, <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">summary</span>(Expt.prcomp)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="st">&quot;PC1&quot;</span>],<span class="dv">1</span>),<span class="st">&#39;%)&#39;</span>),</span>
<span id="cb22-29"><a href="load-data.html#cb22-29" aria-hidden="true"></a>      <span class="dt">y=</span>Expt.prcomp<span class="op">$</span>rotation[,<span class="st">&#39;PC2&#39;</span>],</span>
<span id="cb22-30"><a href="load-data.html#cb22-30" aria-hidden="true"></a>      <span class="dt">ylab=</span><span class="kw">paste0</span>(<span class="st">&#39;PC2 (&#39;</span>, <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">summary</span>(Expt.prcomp)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="st">&quot;PC2&quot;</span>],<span class="dv">1</span>),<span class="st">&#39;%)&#39;</span>),</span>
<span id="cb22-31"><a href="load-data.html#cb22-31" aria-hidden="true"></a>      <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, <span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(MSS_MSI)))</span>
<span id="cb22-32"><a href="load-data.html#cb22-32" aria-hidden="true"></a> <span class="kw">title</span>(<span class="st">&#39;Color is MSS_MSI&#39;</span>)</span>
<span id="cb22-33"><a href="load-data.html#cb22-33" aria-hidden="true"></a></span>
<span id="cb22-34"><a href="load-data.html#cb22-34" aria-hidden="true"></a> legend.tbl &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="kw">as.factor</span>(MSS_MSI), </span>
<span id="cb22-35"><a href="load-data.html#cb22-35" aria-hidden="true"></a>                     <span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(MSS_MSI)))</span>
<span id="cb22-36"><a href="load-data.html#cb22-36" aria-hidden="true"></a> <span class="kw">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, </span>
<span id="cb22-37"><a href="load-data.html#cb22-37" aria-hidden="true"></a>         <span class="dt">legend=</span><span class="kw">rownames</span>(legend.tbl),</span>
<span id="cb22-38"><a href="load-data.html#cb22-38" aria-hidden="true"></a>         <span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">colnames</span>(legend.tbl)))</span>
<span id="cb22-39"><a href="load-data.html#cb22-39" aria-hidden="true"></a></span>
<span id="cb22-40"><a href="load-data.html#cb22-40" aria-hidden="true"></a> <span class="kw">mtext</span>(<span class="dt">side=</span><span class="dv">3</span>, <span class="dt">outer=</span>T, <span class="dt">cex=</span><span class="fl">1.25</span>, <span class="st">&quot;Pooled GSE Data - Before Batch Correction&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:load-data-plot-poolGSE"></span>
<img src="Static/figures/load-data-plot-poolGSE-1.png" alt="Pooled GSE Data - Before Batch Correction" width="1056" />
<p class="caption">
Figure 2.1: Pooled GSE Data - Before Batch Correction
</p>
</div>
<!-- ######################################################################## -->
</div>
<div id="batch-correction" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> Batch Correction</h2>
<p>We see a definite batch effect in the PCA plot based on the pooled expression data.
The clustering is along probe set reduction method, RMA vs MAS 5.0.
One should really go back to the cel files and re-analyze all samples using one
probe set reduction method. For the sake of illustration, we will instead try to
remove this effect using a batch-effect correction method.</p>
<p>Given that we don’t have a good set of control genes as required by the RUV method, we’ll
use ’ComBat` from the
<a href="https://www.bioconductor.org/packages/release/bioc/html/sva.html">SVA</a>
package.</p>
<p>Alternatively, we could keep keep the two sets of data, those summarized using RMA
and those summarized using MAS 5.0, separate, alternating using one set for
model selection and fitting and the other for testing. This would provide
a strong test of the generalizability and robustness of the results.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="load-data.html#cb23-1" aria-hidden="true"></a> <span class="kw">suppressMessages</span>(<span class="kw">require</span>(sva))</span>
<span id="cb23-2"><a href="load-data.html#cb23-2" aria-hidden="true"></a></span>
<span id="cb23-3"><a href="load-data.html#cb23-3" aria-hidden="true"></a> <span class="kw">load</span>(<span class="dt">file=</span><span class="kw">file.path</span>(<span class="st">&#39;RData&#39;</span>,<span class="st">&#39;GSEPool.arrayGeneExpr&#39;</span>))</span>
<span id="cb23-4"><a href="load-data.html#cb23-4" aria-hidden="true"></a></span>
<span id="cb23-5"><a href="load-data.html#cb23-5" aria-hidden="true"></a> Expr.mtx &lt;-<span class="st"> </span>GSEPool.arrayGeneExpr<span class="op">$</span>exprData</span>
<span id="cb23-6"><a href="load-data.html#cb23-6" aria-hidden="true"></a> sampAttr.frm &lt;-<span class="st"> </span>GSEPool.arrayGeneExpr<span class="op">$</span>sampAttr</span>
<span id="cb23-7"><a href="load-data.html#cb23-7" aria-hidden="true"></a></span>
<span id="cb23-8"><a href="load-data.html#cb23-8" aria-hidden="true"></a></span>
<span id="cb23-9"><a href="load-data.html#cb23-9" aria-hidden="true"></a> <span class="co"># Applying theComBatfunction to adjust for known batches</span></span>
<span id="cb23-10"><a href="load-data.html#cb23-10" aria-hidden="true"></a> <span class="co"># Note: we could here use a binray batch: RMA vs MAS5.</span></span>
<span id="cb23-11"><a href="load-data.html#cb23-11" aria-hidden="true"></a> batch &lt;-<span class="st"> </span><span class="kw">as.factor</span>(sampAttr.frm<span class="op">$</span>GSE)</span>
<span id="cb23-12"><a href="load-data.html#cb23-12" aria-hidden="true"></a></span>
<span id="cb23-13"><a href="load-data.html#cb23-13" aria-hidden="true"></a> <span class="kw">with</span>(sampAttr.frm, <span class="kw">table</span>(GSE, MS_Status))</span></code></pre></div>
<pre><code>##           MS_Status
## GSE        High Low MSI MSS No
##   GSE13067    0   0  11  63  0
##   GSE13294    0   0  78  77  0
##   GSE35896    0   0   5  56  0
##   GSE39084   16   3   0   0 51
##   GSE4554     0   0  33  50  0</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="load-data.html#cb25-1" aria-hidden="true"></a> MSS &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">is.element</span>(sampAttr.frm<span class="op">$</span>MS_Status, <span class="kw">c</span>(<span class="st">&#39;MSS&#39;</span>, <span class="st">&#39;No&#39;</span>)))</span>
<span id="cb25-2"><a href="load-data.html#cb25-2" aria-hidden="true"></a> modcombat =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="st"> </span>MSS)</span>
<span id="cb25-3"><a href="load-data.html#cb25-3" aria-hidden="true"></a></span>
<span id="cb25-4"><a href="load-data.html#cb25-4" aria-hidden="true"></a> combat_edata =<span class="st"> </span><span class="kw">ComBat</span>(<span class="dt">dat=</span>Expr.mtx, </span>
<span id="cb25-5"><a href="load-data.html#cb25-5" aria-hidden="true"></a>                       <span class="dt">batch=</span>batch, </span>
<span id="cb25-6"><a href="load-data.html#cb25-6" aria-hidden="true"></a>                       <span class="dt">mod=</span>modcombat, </span>
<span id="cb25-7"><a href="load-data.html#cb25-7" aria-hidden="true"></a>                       <span class="dt">par.prior=</span><span class="ot">TRUE</span>, </span>
<span id="cb25-8"><a href="load-data.html#cb25-8" aria-hidden="true"></a>                       <span class="dt">prior.plots=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## Found5batches</code></pre>
<pre><code>## Adjusting for1covariate(s) or covariate level(s)</code></pre>
<pre><code>## Standardizing Data across genes</code></pre>
<pre><code>## Fitting L/S model and finding priors</code></pre>
<pre><code>## Finding parametric adjustments</code></pre>
<pre><code>## Adjusting the Data</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="load-data.html#cb32-1" aria-hidden="true"></a> GSEPool.arrayGeneExpr<span class="op">$</span>exprDataBatchAdj &lt;-<span class="st"> </span>combat_edata</span>
<span id="cb32-2"><a href="load-data.html#cb32-2" aria-hidden="true"></a></span>
<span id="cb32-3"><a href="load-data.html#cb32-3" aria-hidden="true"></a> <span class="kw">save</span>(GSEPool.arrayGeneExpr, <span class="dt">file=</span><span class="kw">file.path</span>(<span class="st">&#39;RData&#39;</span>,<span class="st">&#39;GSEPool.arrayGeneExpr&#39;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="load-data.html#cb33-1" aria-hidden="true"></a> <span class="kw">loadObj</span>(<span class="st">&#39;GSEPool.arrayGeneExpr&#39;</span>, <span class="st">&#39;GSEPool.arrayGeneExpr&#39;</span>)</span>
<span id="cb33-2"><a href="load-data.html#cb33-2" aria-hidden="true"></a></span>
<span id="cb33-3"><a href="load-data.html#cb33-3" aria-hidden="true"></a> <span class="co">######################################################</span></span>
<span id="cb33-4"><a href="load-data.html#cb33-4" aria-hidden="true"></a> <span class="co"># Look for inter-set batch effects</span></span>
<span id="cb33-5"><a href="load-data.html#cb33-5" aria-hidden="true"></a> <span class="co">######################################################</span></span>
<span id="cb33-6"><a href="load-data.html#cb33-6" aria-hidden="true"></a> Expt.prcomp &lt;-<span class="st"> </span><span class="kw">prcomp</span>(GSEPool.arrayGeneExpr<span class="op">$</span>exprDataBatchAdj)</span>
<span id="cb33-7"><a href="load-data.html#cb33-7" aria-hidden="true"></a>  </span>
<span id="cb33-8"><a href="load-data.html#cb33-8" aria-hidden="true"></a> <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>))</span>
<span id="cb33-9"><a href="load-data.html#cb33-9" aria-hidden="true"></a> <span class="co"># Annotate with Batch</span></span>
<span id="cb33-10"><a href="load-data.html#cb33-10" aria-hidden="true"></a> <span class="kw">plot</span>(<span class="dt">x=</span>Expt.prcomp<span class="op">$</span>rotation[,<span class="st">&#39;PC1&#39;</span>],</span>
<span id="cb33-11"><a href="load-data.html#cb33-11" aria-hidden="true"></a>      <span class="dt">xlab=</span><span class="kw">paste0</span>(<span class="st">&#39;PC1 (&#39;</span>, <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">summary</span>(Expt.prcomp)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="st">&quot;PC1&quot;</span>],<span class="dv">1</span>),<span class="st">&#39;%)&#39;</span>),</span>
<span id="cb33-12"><a href="load-data.html#cb33-12" aria-hidden="true"></a>      <span class="dt">y=</span>Expt.prcomp<span class="op">$</span>rotation[,<span class="st">&#39;PC2&#39;</span>],</span>
<span id="cb33-13"><a href="load-data.html#cb33-13" aria-hidden="true"></a>      <span class="dt">ylab=</span><span class="kw">paste0</span>(<span class="st">&#39;PC2 (&#39;</span>, <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">summary</span>(Expt.prcomp)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="st">&quot;PC2&quot;</span>],<span class="dv">1</span>),<span class="st">&#39;%)&#39;</span>),</span>
<span id="cb33-14"><a href="load-data.html#cb33-14" aria-hidden="true"></a>      <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, <span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(sampAttr.frm<span class="op">$</span>GSE)))</span>
<span id="cb33-15"><a href="load-data.html#cb33-15" aria-hidden="true"></a> <span class="kw">title</span>(<span class="st">&#39;Color is Batch&#39;</span>)</span>
<span id="cb33-16"><a href="load-data.html#cb33-16" aria-hidden="true"></a></span>
<span id="cb33-17"><a href="load-data.html#cb33-17" aria-hidden="true"></a> legend.tbl &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="kw">as.factor</span>(sampAttr.frm<span class="op">$</span>GSE), </span>
<span id="cb33-18"><a href="load-data.html#cb33-18" aria-hidden="true"></a>                     <span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(sampAttr.frm<span class="op">$</span>GSE)))</span>
<span id="cb33-19"><a href="load-data.html#cb33-19" aria-hidden="true"></a>SKIP &lt;-<span class="st"> </span><span class="cf">function</span>() {</span>
<span id="cb33-20"><a href="load-data.html#cb33-20" aria-hidden="true"></a> <span class="kw">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, </span>
<span id="cb33-21"><a href="load-data.html#cb33-21" aria-hidden="true"></a>         <span class="dt">legend=</span><span class="kw">rownames</span>(legend.tbl),</span>
<span id="cb33-22"><a href="load-data.html#cb33-22" aria-hidden="true"></a>         <span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">colnames</span>(legend.tbl)))</span>
<span id="cb33-23"><a href="load-data.html#cb33-23" aria-hidden="true"></a>}<span class="co">#SKIP</span></span>
<span id="cb33-24"><a href="load-data.html#cb33-24" aria-hidden="true"></a></span>
<span id="cb33-25"><a href="load-data.html#cb33-25" aria-hidden="true"></a> <span class="co"># Annotate with MS_Status</span></span>
<span id="cb33-26"><a href="load-data.html#cb33-26" aria-hidden="true"></a> MSS_MSI &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">ifelse</span>(<span class="kw">is.element</span>(sampAttr.frm<span class="op">$</span>MS_Status, <span class="kw">c</span>(<span class="st">&#39;MSS&#39;</span>, <span class="st">&#39;No&#39;</span>)),</span>
<span id="cb33-27"><a href="load-data.html#cb33-27" aria-hidden="true"></a>          <span class="st">&#39;MSS&#39;</span>,<span class="st">&#39;MSI&#39;</span>))</span>
<span id="cb33-28"><a href="load-data.html#cb33-28" aria-hidden="true"></a> <span class="kw">plot</span>(<span class="dt">x=</span>Expt.prcomp<span class="op">$</span>rotation[,<span class="st">&#39;PC1&#39;</span>],</span>
<span id="cb33-29"><a href="load-data.html#cb33-29" aria-hidden="true"></a>      <span class="dt">xlab=</span><span class="kw">paste0</span>(<span class="st">&#39;PC1 (&#39;</span>, <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">summary</span>(Expt.prcomp)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="st">&quot;PC1&quot;</span>],<span class="dv">1</span>),<span class="st">&#39;%)&#39;</span>),</span>
<span id="cb33-30"><a href="load-data.html#cb33-30" aria-hidden="true"></a>      <span class="dt">y=</span>Expt.prcomp<span class="op">$</span>rotation[,<span class="st">&#39;PC2&#39;</span>],</span>
<span id="cb33-31"><a href="load-data.html#cb33-31" aria-hidden="true"></a>      <span class="dt">ylab=</span><span class="kw">paste0</span>(<span class="st">&#39;PC2 (&#39;</span>, <span class="kw">round</span>(<span class="dv">100</span><span class="op">*</span><span class="kw">summary</span>(Expt.prcomp)<span class="op">$</span>importance[<span class="dv">2</span>,<span class="st">&quot;PC2&quot;</span>],<span class="dv">1</span>),<span class="st">&#39;%)&#39;</span>),</span>
<span id="cb33-32"><a href="load-data.html#cb33-32" aria-hidden="true"></a>      <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, <span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(MSS_MSI)))</span>
<span id="cb33-33"><a href="load-data.html#cb33-33" aria-hidden="true"></a> <span class="kw">title</span>(<span class="st">&#39;Color is MSS_MSI&#39;</span>)</span>
<span id="cb33-34"><a href="load-data.html#cb33-34" aria-hidden="true"></a></span>
<span id="cb33-35"><a href="load-data.html#cb33-35" aria-hidden="true"></a> legend.tbl &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="kw">as.factor</span>(MSS_MSI), </span>
<span id="cb33-36"><a href="load-data.html#cb33-36" aria-hidden="true"></a>                     <span class="kw">as.numeric</span>(<span class="kw">as.factor</span>(MSS_MSI)))</span>
<span id="cb33-37"><a href="load-data.html#cb33-37" aria-hidden="true"></a> <span class="kw">legend</span>(<span class="st">&#39;topright&#39;</span>, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">cex=</span><span class="fl">1.5</span>, </span>
<span id="cb33-38"><a href="load-data.html#cb33-38" aria-hidden="true"></a>         <span class="dt">legend=</span><span class="kw">rownames</span>(legend.tbl),</span>
<span id="cb33-39"><a href="load-data.html#cb33-39" aria-hidden="true"></a>         <span class="dt">col=</span><span class="kw">as.numeric</span>(<span class="kw">colnames</span>(legend.tbl)))</span>
<span id="cb33-40"><a href="load-data.html#cb33-40" aria-hidden="true"></a></span>
<span id="cb33-41"><a href="load-data.html#cb33-41" aria-hidden="true"></a> <span class="kw">mtext</span>(<span class="dt">side=</span><span class="dv">3</span>, <span class="dt">outer=</span>T, <span class="dt">cex=</span><span class="fl">1.25</span>, <span class="st">&quot;Pooled GSE Data - After Batch Correction&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:load-data-plot-svaBatchAdjust"></span>
<img src="Static/figures/load-data-plot-svaBatchAdjust-1.png" alt="Pooled GSE Data - After Batch Correction" width="1056" />
<p class="caption">
Figure 2.2: Pooled GSE Data - After Batch Correction
</p>
</div>
<!-- ######################################################################## -->
<p>Visual inspection of the effect of the batch correction transformation
is a minimal requirement for verification. One can do a better job
at quantifying the effect of batch correction, especially of the data set
contains control features and control samples. See Lazar et.al. <span class="citation">[<a href="#ref-Lazar:2013aa" role="doc-biblioref">3</a>]</span>
for a discussion of batch effect removal assessment.</p>
</div>
<div id="separate-data-set-into-train-and-test-subsets" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Separate Data Set into Train and Test Subsets</h2>
<p>We will separate the data set into <strong>Train</strong> and <strong>Test</strong> subsets here, before
any other filtering or data manipulation. In particular, since we will
be interested in evaluating the effect of gene or probe set selection,
this selection must be made on the basis of the training subset only.
This is done as a precautionary measure as gene selection based on
a variability filter is is done here is unlikely to have an effect on sample classification
performance.</p>
<p>Take note that the expression matrices that we save here will
be transposed with <code>genes in columns</code>. This is done to accomodate
the data format expected by the <code>caret</code> package.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="load-data.html#cb34-1" aria-hidden="true"></a> <span class="co"># CHANGE THIS LINE TO CLEAR CACHE</span></span>
<span id="cb34-2"><a href="load-data.html#cb34-2" aria-hidden="true"></a> <span class="kw">suppressMessages</span>(<span class="kw">require</span>(caret))</span>
<span id="cb34-3"><a href="load-data.html#cb34-3" aria-hidden="true"></a></span>
<span id="cb34-4"><a href="load-data.html#cb34-4" aria-hidden="true"></a> <span class="co"># Load expression  data object</span></span>
<span id="cb34-5"><a href="load-data.html#cb34-5" aria-hidden="true"></a> <span class="kw">load</span>(<span class="kw">file.path</span>(<span class="st">&#39;RData&#39;</span>,<span class="st">&#39;GSEPool.arrayGeneExpr&#39;</span>))</span>
<span id="cb34-6"><a href="load-data.html#cb34-6" aria-hidden="true"></a></span>
<span id="cb34-7"><a href="load-data.html#cb34-7" aria-hidden="true"></a> <span class="co"># Get expression data matrix </span></span>
<span id="cb34-8"><a href="load-data.html#cb34-8" aria-hidden="true"></a> Expr.mtx &lt;-<span class="st"> </span><span class="kw">t</span>(GSEPool.arrayGeneExpr<span class="op">$</span>exprDataBatchAdj)</span>
<span id="cb34-9"><a href="load-data.html#cb34-9" aria-hidden="true"></a></span>
<span id="cb34-10"><a href="load-data.html#cb34-10" aria-hidden="true"></a> <span class="co"># Use gene names where possible</span></span>
<span id="cb34-11"><a href="load-data.html#cb34-11" aria-hidden="true"></a> <span class="kw">colnames</span>(Expr.mtx) &lt;-<span class="st"> </span></span>
<span id="cb34-12"><a href="load-data.html#cb34-12" aria-hidden="true"></a><span class="st"> </span><span class="kw">make.names</span>(GSEPool.arrayGeneExpr<span class="op">$</span>featureAttr[<span class="kw">colnames</span>(Expr.mtx),], <span class="dt">unique=</span>T)</span>
<span id="cb34-13"><a href="load-data.html#cb34-13" aria-hidden="true"></a></span>
<span id="cb34-14"><a href="load-data.html#cb34-14" aria-hidden="true"></a> <span class="co"># Keep map</span></span>
<span id="cb34-15"><a href="load-data.html#cb34-15" aria-hidden="true"></a> GeneNameMap.vec &lt;-<span class="st"> </span><span class="kw">rownames</span>(GSEPool.arrayGeneExpr<span class="op">$</span>exprDataBatchAdj)</span>
<span id="cb34-16"><a href="load-data.html#cb34-16" aria-hidden="true"></a> <span class="kw">names</span>(GeneNameMap.vec) &lt;-<span class="st"> </span><span class="kw">colnames</span>(Expr.mtx)</span>
<span id="cb34-17"><a href="load-data.html#cb34-17" aria-hidden="true"></a></span>
<span id="cb34-18"><a href="load-data.html#cb34-18" aria-hidden="true"></a> <span class="co">#GeneNameMap.vec[1:5]</span></span>
<span id="cb34-19"><a href="load-data.html#cb34-19" aria-hidden="true"></a></span>
<span id="cb34-20"><a href="load-data.html#cb34-20" aria-hidden="true"></a> <span class="kw">save</span>(GeneNameMap.vec, <span class="dt">file=</span><span class="kw">file.path</span>(<span class="st">&#39;RData&#39;</span>, <span class="st">&#39;GeneNameMap.vec&#39;</span>))</span>
<span id="cb34-21"><a href="load-data.html#cb34-21" aria-hidden="true"></a></span>
<span id="cb34-22"><a href="load-data.html#cb34-22" aria-hidden="true"></a> <span class="co"># Get sample attributes</span></span>
<span id="cb34-23"><a href="load-data.html#cb34-23" aria-hidden="true"></a> sampAttr.frm &lt;-<span class="st"> </span>GSEPool.arrayGeneExpr<span class="op">$</span>sampAttr</span>
<span id="cb34-24"><a href="load-data.html#cb34-24" aria-hidden="true"></a></span>
<span id="cb34-25"><a href="load-data.html#cb34-25" aria-hidden="true"></a> DataSource.vec &lt;-<span class="st"> </span>sampAttr.frm<span class="op">$</span>GSE</span>
<span id="cb34-26"><a href="load-data.html#cb34-26" aria-hidden="true"></a> <span class="kw">names</span>(DataSource.vec) &lt;-<span class="st"> </span><span class="kw">rownames</span>(sampAttr.frm)</span>
<span id="cb34-27"><a href="load-data.html#cb34-27" aria-hidden="true"></a></span>
<span id="cb34-28"><a href="load-data.html#cb34-28" aria-hidden="true"></a> Label.vec &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">is.element</span>(sampAttr.frm<span class="op">$</span>MS_Status, <span class="kw">c</span>(<span class="st">&#39;MSS&#39;</span>, <span class="st">&#39;No&#39;</span>)), <span class="st">&#39;MSS&#39;</span>,<span class="st">&#39;MSI&#39;</span>)</span>
<span id="cb34-29"><a href="load-data.html#cb34-29" aria-hidden="true"></a> <span class="kw">names</span>(Label.vec) &lt;-<span class="st"> </span><span class="kw">rownames</span>(sampAttr.frm)</span>
<span id="cb34-30"><a href="load-data.html#cb34-30" aria-hidden="true"></a> <span class="kw">rm</span>(GSEPool.arrayGeneExpr)</span>
<span id="cb34-31"><a href="load-data.html#cb34-31" aria-hidden="true"></a></span>
<span id="cb34-32"><a href="load-data.html#cb34-32" aria-hidden="true"></a> <span class="co"># split Into Train and Test</span></span>
<span id="cb34-33"><a href="load-data.html#cb34-33" aria-hidden="true"></a> <span class="kw">set.seed</span>(<span class="dv">12379</span>)</span>
<span id="cb34-34"><a href="load-data.html#cb34-34" aria-hidden="true"></a> inTrain &lt;-<span class="st"> </span><span class="kw">createDataPartition</span>(<span class="dt">y=</span>Label.vec, <span class="dt">p=</span><span class="fl">0.75</span>, <span class="dt">list=</span>F)</span>
<span id="cb34-35"><a href="load-data.html#cb34-35" aria-hidden="true"></a></span>
<span id="cb34-36"><a href="load-data.html#cb34-36" aria-hidden="true"></a> Train.Expr.mtx &lt;-<span class="st"> </span>Expr.mtx[inTrain,]</span>
<span id="cb34-37"><a href="load-data.html#cb34-37" aria-hidden="true"></a> Train.Label.vec &lt;-<span class="st"> </span>Label.vec[inTrain]</span>
<span id="cb34-38"><a href="load-data.html#cb34-38" aria-hidden="true"></a> Train.DataSource.vec &lt;-<span class="st"> </span>DataSource.vec[inTrain]</span>
<span id="cb34-39"><a href="load-data.html#cb34-39" aria-hidden="true"></a></span>
<span id="cb34-40"><a href="load-data.html#cb34-40" aria-hidden="true"></a></span>
<span id="cb34-41"><a href="load-data.html#cb34-41" aria-hidden="true"></a> Test.Expr.mtx &lt;-<span class="st"> </span>Expr.mtx[<span class="op">-</span>inTrain,]</span>
<span id="cb34-42"><a href="load-data.html#cb34-42" aria-hidden="true"></a> Test.Label.vec &lt;-<span class="st"> </span>Label.vec[<span class="op">-</span>inTrain]</span>
<span id="cb34-43"><a href="load-data.html#cb34-43" aria-hidden="true"></a> Test.DataSource.vec &lt;-<span class="st"> </span>Label.vec[<span class="op">-</span>inTrain]</span>
<span id="cb34-44"><a href="load-data.html#cb34-44" aria-hidden="true"></a></span>
<span id="cb34-45"><a href="load-data.html#cb34-45" aria-hidden="true"></a> knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">rbind</span>(<span class="dt">Train=</span><span class="kw">dim</span>(Train.Expr.mtx),</span>
<span id="cb34-46"><a href="load-data.html#cb34-46" aria-hidden="true"></a>             <span class="dt">Test=</span><span class="kw">dim</span>(Test.Expr.mtx))) <span class="op">%&gt;%</span></span>
<span id="cb34-47"><a href="load-data.html#cb34-47" aria-hidden="true"></a><span class="st">        </span>kableExtra<span class="op">::</span><span class="kw">kable_styling</span>(<span class="dt">full_width =</span> F)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
Train
</td>
<td style="text-align:right;">
333
</td>
<td style="text-align:right;">
54675
</td>
</tr>
<tr>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
54675
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="load-data.html#cb35-1" aria-hidden="true"></a> knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">rbind</span>(</span>
<span id="cb35-2"><a href="load-data.html#cb35-2" aria-hidden="true"></a> <span class="dt">Train=</span><span class="kw">table</span>(Train.Label.vec)<span class="op">/</span><span class="kw">length</span>(Train.Label.vec),</span>
<span id="cb35-3"><a href="load-data.html#cb35-3" aria-hidden="true"></a> <span class="dt">Test=</span><span class="kw">table</span>(Test.Label.vec)<span class="op">/</span><span class="kw">length</span>(Test.Label.vec))) <span class="op">%&gt;%</span></span>
<span id="cb35-4"><a href="load-data.html#cb35-4" aria-hidden="true"></a><span class="st">        </span>kableExtra<span class="op">::</span><span class="kw">kable_styling</span>(<span class="dt">full_width =</span> F)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
MSI
</th>
<th style="text-align:right;">
MSS
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Train
</td>
<td style="text-align:right;">
0.3303303
</td>
<td style="text-align:right;">
0.6696697
</td>
</tr>
<tr>
<td style="text-align:left;">
Test
</td>
<td style="text-align:right;">
0.3272727
</td>
<td style="text-align:right;">
0.6727273
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="load-data.html#cb36-1" aria-hidden="true"></a> <span class="co"># Save these</span></span>
<span id="cb36-2"><a href="load-data.html#cb36-2" aria-hidden="true"></a> <span class="kw">save</span>(Train.Expr.mtx, <span class="dt">file=</span><span class="kw">file.path</span>(<span class="st">&#39;RData&#39;</span>, <span class="st">&#39;Train.Expr.mtx&#39;</span>))</span>
<span id="cb36-3"><a href="load-data.html#cb36-3" aria-hidden="true"></a> <span class="kw">save</span>(Test.Expr.mtx, <span class="dt">file=</span><span class="kw">file.path</span>(<span class="st">&#39;RData&#39;</span>, <span class="st">&#39;Test.Expr.mtx&#39;</span>))</span>
<span id="cb36-4"><a href="load-data.html#cb36-4" aria-hidden="true"></a> <span class="kw">save</span>(Train.Label.vec, <span class="dt">file=</span><span class="kw">file.path</span>(<span class="st">&#39;RData&#39;</span>, <span class="st">&#39;Train.Label.vec&#39;</span>))</span>
<span id="cb36-5"><a href="load-data.html#cb36-5" aria-hidden="true"></a> <span class="kw">save</span>(Test.Label.vec, <span class="dt">file=</span><span class="kw">file.path</span>(<span class="st">&#39;RData&#39;</span>, <span class="st">&#39;Test.Label.vec&#39;</span>))</span>
<span id="cb36-6"><a href="load-data.html#cb36-6" aria-hidden="true"></a> <span class="kw">save</span>(Train.DataSource.vec, <span class="dt">file=</span><span class="kw">file.path</span>(<span class="st">&#39;RData&#39;</span>, <span class="st">&#39;Train.DataSource.vec&#39;</span>))</span>
<span id="cb36-7"><a href="load-data.html#cb36-7" aria-hidden="true"></a> <span class="kw">save</span>(Test.DataSource.vec, <span class="dt">file=</span><span class="kw">file.path</span>(<span class="st">&#39;RData&#39;</span>, <span class="st">&#39;Test.DataSource.vec&#39;</span>))</span></code></pre></div>
<!-- ######################################################################## -->
</div>
<div id="save-gene-sets" class="section level2" number="2.7">
<h2><span class="header-section-number">2.7</span> Save Gene Sets</h2>
<p>Save gene sets selected by overall variability <em>in training samples</em>.
<!-- In the interest of conserving computing resources,--> In the analysis
that follows we will use the top 30%
most variable genes.</p>
<p>Note that we select genes based on variability in the entire training
dataset which includes data from different GEO data sets. This selection
may favor the inclusion of genes which differ across the different
data sets due to technical reasons. An alternative selection would be to
to select genes based on within data set variability. This could be
implemented by filtering based on the residual variance of an
ANOVA model <code>Expr ~ GSE</code> fitted to the gene expression data.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="load-data.html#cb37-1" aria-hidden="true"></a> <span class="co"># CHANGE THIS LINE TO CLEAR CACHE</span></span>
<span id="cb37-2"><a href="load-data.html#cb37-2" aria-hidden="true"></a> <span class="kw">load</span>(<span class="kw">file.path</span>(<span class="st">&#39;RData&#39;</span>, <span class="st">&#39;Train.Expr.mtx&#39;</span>))</span>
<span id="cb37-3"><a href="load-data.html#cb37-3" aria-hidden="true"></a></span>
<span id="cb37-4"><a href="load-data.html#cb37-4" aria-hidden="true"></a> <span class="co"># Identify and remove low variance columns</span></span>
<span id="cb37-5"><a href="load-data.html#cb37-5" aria-hidden="true"></a> Train.Expr.mad.vec &lt;-<span class="st"> </span><span class="kw">apply</span>(Train.Expr.mtx,<span class="dv">2</span>,mad)</span>
<span id="cb37-6"><a href="load-data.html#cb37-6" aria-hidden="true"></a> <span class="co">#summary(Train.Expr.mad.vec)</span></span>
<span id="cb37-7"><a href="load-data.html#cb37-7" aria-hidden="true"></a></span>
<span id="cb37-8"><a href="load-data.html#cb37-8" aria-hidden="true"></a> TopVar.cols &lt;-<span class="st"> </span><span class="kw">which</span>(Train.Expr.mad.vec <span class="op">&gt;</span><span class="st"> </span><span class="kw">quantile</span>(Train.Expr.mad.vec, <span class="dt">prob=</span>(<span class="dv">100</span><span class="op">-</span>VAR_FILTER)<span class="op">/</span><span class="dv">100</span>))</span>
<span id="cb37-9"><a href="load-data.html#cb37-9" aria-hidden="true"></a> Train.TopVarGenes.vec &lt;-<span class="st"> </span><span class="kw">colnames</span>(Train.Expr.mtx)[TopVar.cols]</span>
<span id="cb37-10"><a href="load-data.html#cb37-10" aria-hidden="true"></a> <span class="co">#length(Train.TopVarVarGenes.vec)</span></span>
<span id="cb37-11"><a href="load-data.html#cb37-11" aria-hidden="true"></a></span>
<span id="cb37-12"><a href="load-data.html#cb37-12" aria-hidden="true"></a> <span class="kw">saveObj</span>(<span class="kw">paste0</span>(<span class="st">&#39;Train.&#39;</span>,SelGenes,<span class="st">&#39;.vec&#39;</span>), <span class="st">&#39;Train.TopVarGenes.vec&#39;</span>)</span>
<span id="cb37-13"><a href="load-data.html#cb37-13" aria-hidden="true"></a></span>
<span id="cb37-14"><a href="load-data.html#cb37-14" aria-hidden="true"></a> <span class="co"># also save top 25 and top 50 - Nawh!</span></span></code></pre></div>
<!-- ######################################################################## -->

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Lazar:2013aa">
<p>3. Lazar, C., Meganck, S., Taminau, J., Steenhoff, D., Coletta, A., Molter, C., Weiss-Solı́s, D.Y., Duque, R., Bersini, H., and Nowé, A. Batch effect removal methods for microarray gene expression data integration: A survey. Briefings in Bioinformatics <em>14</em>, 469–490. Available at: <a href="http://dx.doi.org/10.1093/bib/bbs037">http://dx.doi.org/10.1093/bib/bbs037</a>.</p>
</div>
<div id="ref-Gagnon-Bartsch:2012aa">
<p>5. Gagnon-Bartsch, J.A., and Speed, T.P. Using control genes to correct for unwanted variation in microarray data. Biostatistics <em>13</em>, 539–552. Available at: <a href="http://dx.doi.org/10.1093/biostatistics/kxr034">http://dx.doi.org/10.1093/biostatistics/kxr034</a>.</p>
</div>
<div id="ref-Molania:2019aa">
<p>6. Molania, R., Gagnon-Bartsch, J.A., Dobrovic, A., and Speed, T.P. A new normalization for nanostring nCounter gene expression data. Nucleic acids research <em>47</em>, 6073–6083. Available at: <a href="https://pubmed.ncbi.nlm.nih.gov/31114909">https://pubmed.ncbi.nlm.nih.gov/31114909</a>.</p>
</div>
<div id="ref-Watanabe:2006aa">
<p>10. Watanabe, T., Kobunai, T., Toda, E., Yamamoto, Y., Kanazawa, T., Kazama, Y., Tanaka, J., Tanaka, T., Konishi, T., and Okayama, Y. <em>et al.</em> Distal colorectal cancers with microsatellite instability (msi) display distinct gene expression profiles that are different from proximal msi cancers. Cancer Research <em>66</em>, 9804. Available at: <a href="http://cancerres.aacrjournals.org/content/66/20/9804.abstract">http://cancerres.aacrjournals.org/content/66/20/9804.abstract</a>.</p>
</div>
<div id="ref-Jorissen:2008aa">
<p>11. Jorissen, R.N., Lipton, L., Gibbs, P., Chapman, M., Desai, J., Jones, I.T., Yeatman, T.J., East, P., Tomlinson, I.P.M., and Verspaget, H.W. <em>et al.</em> DNA copy-number alterations underlie gene expression differences between microsatellite stable and unstable colorectal cancers. Clinical Cancer Research <em>14</em>, 8061. Available at: <a href="http://clincancerres.aacrjournals.org/content/14/24/8061.abstract">http://clincancerres.aacrjournals.org/content/14/24/8061.abstract</a>.</p>
</div>
<div id="ref-Alhopuro:2012aa">
<p>12. Alhopuro, P., Sammalkorpi, H., Niittymäki, I., Biström, M., Raitila, A., Saharinen, J., Nousiainen, K., Lehtonen, H.J., Heliövaara, E., and Puhakka, J. <em>et al.</em> (2012). Candidate driver genes in microsatellite-unstable colorectal cancer. International Journal of Cancer <em>130</em>, 1558–1566. Available at: <a href="http://dx.doi.org/10.1002/ijc.26167">http://dx.doi.org/10.1002/ijc.26167</a>.</p>
</div>
<div id="ref-Watanabe:2012aa">
<p>13. Watanabe, T., Kobunai, T., Yamamoto, Y., Matsuda, K., Ishihara, S., Nozawa, K., Yamada, H., Hayama, T., Inoue, E., and Tamura, J. <em>et al.</em> Chromosomal instability (cin) phenotype, cin high or cin low, predicts survival for colorectal cancer. Journal of Clinical Oncology <em>30</em>, 2256–2264. Available at: <a href="https://doi.org/10.1200/JCO.2011.38.6490">https://doi.org/10.1200/JCO.2011.38.6490</a>.</p>
</div>
<div id="ref-Schlicker:2012aa">
<p>14. Schlicker, A., Beran, G., Chresta, C.M., McWalter, G., Pritchard, A., Weston, S., Runswick, S., Davenport, S., Heathcote, K., and Castro, D.A. <em>et al.</em> (2012). Subtypes of primary colorectal tumors correlate with response to targeted treatment in colorectal cell lines. BMC Medical Genomics <em>5</em>, 66–66. Available at: <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3543849/">http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3543849/</a>.</p>
</div>
<div id="ref-Barras:2017aa">
<p>15. Barras, D., Missiaglia, E., Wirapati, P., Sieber, O.M., Jorissen, R.N., Love, C., Molloy, P.L., Jones, I.T., McLaughlin, S., and Gibbs, P. <em>et al.</em> <span class="math inline">\(&lt;\)</span>em<span class="math inline">\(&gt;\)</span>BRAF<span class="math inline">\(&lt;\)</span>/em<span class="math inline">\(&gt;\)</span> <span class="math inline">\(&lt;\)</span>em<span class="math inline">\(&gt;\)</span>V600E<span class="math inline">\(&lt;\)</span>/em<span class="math inline">\(&gt;\)</span> mutant colorectal cancer subtypes based on gene expression. Clinical Cancer Research <em>23</em>, 104. Available at: <a href="http://clincancerres.aacrjournals.org/content/23/1/104.abstract">http://clincancerres.aacrjournals.org/content/23/1/104.abstract</a>.</p>
</div>
<div id="ref-Kirzin:2014aa">
<p>16. Kirzin, S., Marisa, L., Guimbaud, R., De Reynies, A., Legrain, M., Laurent-Puig, P., Cordelier, P., Pradère, B., Bonnet, D., and Meggetto, F. <em>et al.</em> (2014). Sporadic early-onset colorectal cancer is a specific sub-type of cancer: A morphological, molecular and genetics study. PLoS ONE <em>9</em>, e103159. Available at: <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC4118858/">http://www.ncbi.nlm.nih.gov/pmc/articles/PMC4118858/</a>.</p>
</div>
<div id="ref-Schmit:2015aa">
<p>17. Schmit, S.L., Gollub, J., Shapero, M.H., Huang, S.-C., Rennert, H.S., Finn, A., Rennert, G., and Gruber, S.B. MicroRNA polymorphisms and risk of colorectal cancer. Cancer Epidemiology Biomarkers &amp;amp; Prevention <em>24</em>, 65. Available at: <a href="http://cebp.aacrjournals.org/content/24/1/65.abstract">http://cebp.aacrjournals.org/content/24/1/65.abstract</a>.</p>
</div>
<div id="ref-Yagi:2010aa">
<p>18. Yagi, K., Akagi, K., Hayashi, H., Nagae, G., Tsuji, S., Isagawa, T., Midorikawa, Y., Nishimura, Y., Sakamoto, H., and Seto, Y. <em>et al.</em> Three dna methylation epigenotypes in human colorectal cancer. Clinical Cancer Research <em>16</em>, 21. Available at: <a href="http://clincancerres.aacrjournals.org/content/16/1/21.abstract">http://clincancerres.aacrjournals.org/content/16/1/21.abstract</a>.</p>
</div>
<div id="ref-Laiho:2006aa">
<p>19. Laiho, P., Kokko, A., Vanharanta, S., Salovaara, R., Sammalkorpi, H., Jarvinen, H., Mecklin, J.-P., Karttunen, T.J., Tuppurainen, K., and Davalos, V. <em>et al.</em> Serrated carcinomas form a subclass of colorectal cancer with distinct molecular basis. Oncogene <em>26</em>, 312–320. Available at: <a href="http://dx.doi.org/10.1038/sj.onc.1209778">http://dx.doi.org/10.1038/sj.onc.1209778</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>this search was conducted in 2017<a href="load-data.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="train-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ExploreCRC.pdf", "ExploreCRC.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
